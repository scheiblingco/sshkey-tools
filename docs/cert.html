<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />
<meta name="generator" content="pdoc 0.10.0" />
<title>sshkey_tools.cert API documentation</title>
<meta name="description" content="Contains classes for OpenSSH Certificates, generation, parsing and signing
Raises:
_EX.SSHCertificateException: General error in certificate
…" />
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/sanitize.min.css" integrity="sha256-PK9q560IAAa6WVRRh76LtCaI8pjTJ2z11v0miyNNjrs=" crossorigin>
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/typography.min.css" integrity="sha256-7l/o7C8jubJiy74VsKTidCy1yBkRtiUGbVkYBylBqUg=" crossorigin>
<link rel="stylesheet preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/styles/github.min.css" crossorigin>
<style>:root{--highlight-color:#fe9}.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:30px;overflow:hidden}#sidebar > *:last-child{margin-bottom:2cm}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:1em 0 .50em 0}h3{font-size:1.4em;margin:25px 0 10px 0}h4{margin:0;font-size:105%}h1:target,h2:target,h3:target,h4:target,h5:target,h6:target{background:var(--highlight-color);padding:.2em 0}a{color:#058;text-decoration:none;transition:color .3s ease-in-out}a:hover{color:#e82}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900}pre code{background:#f8f8f8;font-size:.8em;line-height:1.4em}code{background:#f2f2f1;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{background:#f8f8f8;border:0;border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0;padding:1ex}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{margin-top:.6em;font-weight:bold}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-weight:bold;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}dt:target .name{background:var(--highlight-color)}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}td{padding:0 .5em}.admonition{padding:.1em .5em;margin-bottom:1em}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%;height:100vh;overflow:auto;position:sticky;top:0}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.item .name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul{padding-left:1.5em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/highlight.min.js" integrity="sha256-Uv3H6lx7dJmRfRvH8TH6kJD1TSK1aFcwgx+mdg3epi8=" crossorigin></script>
<script>window.addEventListener('DOMContentLoaded', () => hljs.initHighlighting())</script>
</head>
<body>
<main>
<article id="content">
<header>
<h1 class="title">Module <code>sshkey_tools.cert</code></h1>
</header>
<section id="section-intro">
<p>Contains classes for OpenSSH Certificates, generation, parsing and signing</p>
<h2 id="raises">Raises</h2>
<dl>
<dt><code>_EX.SSHCertificateException</code></dt>
<dd>General error in certificate</dd>
<dt><code>_EX.InvalidCertificateFormatException</code></dt>
<dd>An error with the format of the certificate</dd>
<dt><code>_EX.InvalidCertificateFieldException</code></dt>
<dd>An invalid field has been added to the certificate</dd>
<dt><code>_EX.NoPrivateKeyException</code></dt>
<dd>The certificate contains no private key</dd>
<dt><code>_EX.NotSignedException</code></dt>
<dd>The certificate is not signed and cannot be exported</dd>
</dl>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python"># pylint: disable=super-with-arguments
&#34;&#34;&#34;
Contains classes for OpenSSH Certificates, generation, parsing and signing
Raises:
    _EX.SSHCertificateException: General error in certificate
    _EX.InvalidCertificateFormatException: An error with the format of the certificate
    _EX.InvalidCertificateFieldException: An invalid field has been added to the certificate
    _EX.NoPrivateKeyException: The certificate contains no private key
    _EX.NotSignedException: The certificate is not signed and cannot be exported
&#34;&#34;&#34;
from base64 import b64decode, b64encode
from dataclasses import dataclass
from typing import Tuple, Union

from prettytable import PrettyTable

from . import exceptions as _EX
from . import fields as _FIELD
from .keys import PrivateKey, PublicKey
from .utils import concat_to_bytestring, concat_to_string, ensure_bytestring

CERT_TYPES = {
    &#34;ssh-rsa-cert-v01@openssh.com&#34;: (&#34;RsaCertificate&#34;, &#34;RsaPubkeyField&#34;),
    &#34;rsa-sha2-256-cert-v01@openssh.com&#34;: (&#34;RsaCertificate&#34;, &#34;RsaPubkeyField&#34;),
    &#34;rsa-sha2-512-cert-v01@openssh.com&#34;: (&#34;RsaCertificate&#34;, &#34;RsaPubkeyField&#34;),
    &#34;ssh-dss-cert-v01@openssh.com&#34;: (&#34;DsaCertificate&#34;, &#34;DsaPubkeyField&#34;),
    &#34;ecdsa-sha2-nistp256-cert-v01@openssh.com&#34;: (
        &#34;EcdsaCertificate&#34;,
        &#34;EcdsaPubkeyField&#34;,
    ),
    &#34;ecdsa-sha2-nistp384-cert-v01@openssh.com&#34;: (
        &#34;EcdsaCertificate&#34;,
        &#34;EcdsaPubkeyField&#34;,
    ),
    &#34;ecdsa-sha2-nistp521-cert-v01@openssh.com&#34;: (
        &#34;EcdsaCertificate&#34;,
        &#34;EcdsaPubkeyField&#34;,
    ),
    &#34;ssh-ed25519-cert-v01@openssh.com&#34;: (
        &#34;Ed25519Certificate&#34;,
        &#34;Ed25519PubkeyField&#34;,
    ),
}


@dataclass
class Fieldset:
    &#34;&#34;&#34;Set of fields for SSHCertificate class&#34;&#34;&#34;

    DECODE_ORDER = []

    def __table__(self):
        return [getattr(self, item).__table__() for item in self.getattrs()]

    def __setattr__(self, name, value):
        field = getattr(self, name, None)

        if isinstance(value, _FIELD.CertificateField):
            self.replace_field(name, value)
            return

        if callable(field) and not isinstance(field, _FIELD.CertificateField):
            if field.__name__ == &#34;factory&#34;:
                super().__setattr__(name, field())
                self.__setattr__(name, value)
                return

        if isinstance(field, type) and getattr(value, &#34;__name__&#34;, &#34;&#34;) != &#34;factory&#34;:
            super().__setattr__(name, field(value))
            return

        if getattr(value, &#34;__name__&#34;, &#34;&#34;) != &#34;factory&#34;:
            field.value = value
            super().__setattr__(name, field)

    def replace_field(self, name: str, value: Union[_FIELD.CertificateField, type]):
        &#34;&#34;&#34;Completely replace field instead of just setting value (original __setattr__ behaviour)

        Args:
            name (str): The field to replace
            value (Union[_FIELD.CertificateField, type]): The CertificateField
            subclass or instance to replace with
        &#34;&#34;&#34;
        super(Fieldset, self).__setattr__(name, value)

    def get(self, name: str, default=None):
        &#34;&#34;&#34;Get field contents

        Args:
            name (str): Field name
            default (_type_, optional): The default value to return in case the
            field is not set. Defaults to None.

        Returns:
            mixed: The contents of the field
        &#34;&#34;&#34;
        field = getattr(self, name, default)
        if field:
            if isinstance(field, type):
                return field.DEFAULT
            return field.value
        return field

    def getattrs(self) -&gt; tuple:
        &#34;&#34;&#34;Get all class attributes

        Returns:
            tuple: All public class attributes
        &#34;&#34;&#34;
        # pylint: disable=consider-iterating-dictionary
        return tuple(att for att in self.__dict__.keys() if not att.startswith(&#34;_&#34;))

    def validate(self):
        &#34;&#34;&#34;Validate all fields to ensure the data is correct

        Returns:
            bool: True if valid, else exception
        &#34;&#34;&#34;
        ex = []
        for key in self.getattrs():
            if not getattr(self, key).validate():
                list(
                    ex.append(f&#34;{type(x)}: {str(x)}&#34;)
                    for x in getattr(self, key).exception
                    if isinstance(x, Exception)
                )

        return True if len(ex) == 0 else ex

    @classmethod
    def decode(cls, data: bytes) -&gt; Tuple[&#34;Fieldset&#34;, bytes]:
        &#34;&#34;&#34;Decode the certificate field data from a stream of bytes

        Returns:
            Tuple[Fieldset, bytes]: A tuple with the fieldset (Header, Fields or Footer)
            and the remaining bytes.
        &#34;&#34;&#34;
        cl_instance = cls()
        for item in cls.DECODE_ORDER:
            decoded, data = getattr(cl_instance, item).from_decode(data)
            setattr(cl_instance, item, decoded)

        return cl_instance, data


@dataclass
class CertificateHeader(Fieldset):
    &#34;&#34;&#34;Header fields for the certificate&#34;&#34;&#34;

    public_key: _FIELD.PublicKeyField = _FIELD.PublicKeyField.factory
    pubkey_type: _FIELD.PubkeyTypeField = _FIELD.PubkeyTypeField.factory
    nonce: _FIELD.NonceField = _FIELD.NonceField.factory

    DECODE_ORDER = [&#34;pubkey_type&#34;, &#34;nonce&#34;]

    def __bytes__(self):
        return concat_to_bytestring(
            bytes(self.pubkey_type), bytes(self.nonce), bytes(self.public_key)
        )

    @classmethod
    def decode(cls, data: bytes) -&gt; Tuple[&#34;CertificateHeader&#34;, bytes]:
        cl_instance, data = super().decode(data)

        target_class = CERT_TYPES[cl_instance.get(&#34;pubkey_type&#34;)]

        public_key, data = getattr(_FIELD, target_class[1]).from_decode(data)
        cl_instance.public_key = public_key

        return cl_instance, data


@dataclass
# pylint: disable=too-many-instance-attributes
class CertificateFields(Fieldset):
    &#34;&#34;&#34;Information fields for the certificate&#34;&#34;&#34;

    serial: _FIELD.SerialField = _FIELD.SerialField.factory
    cert_type: _FIELD.CertificateTypeField = _FIELD.CertificateTypeField.factory
    key_id: _FIELD.KeyIdField = _FIELD.KeyIdField.factory
    principals: _FIELD.PrincipalsField = _FIELD.PrincipalsField.factory
    valid_after: _FIELD.ValidAfterField = _FIELD.ValidAfterField.factory
    valid_before: _FIELD.ValidBeforeField = _FIELD.ValidBeforeField.factory
    critical_options: _FIELD.CriticalOptionsField = _FIELD.CriticalOptionsField.factory
    extensions: _FIELD.ExtensionsField = _FIELD.ExtensionsField.factory

    DECODE_ORDER = [
        &#34;serial&#34;,
        &#34;cert_type&#34;,
        &#34;key_id&#34;,
        &#34;principals&#34;,
        &#34;valid_after&#34;,
        &#34;valid_before&#34;,
        &#34;critical_options&#34;,
        &#34;extensions&#34;,
    ]

    def __bytes__(self):
        return concat_to_bytestring(
            bytes(self.serial),
            bytes(self.cert_type),
            bytes(self.key_id),
            bytes(self.principals),
            bytes(self.valid_after),
            bytes(self.valid_before),
            bytes(self.critical_options),
            bytes(self.extensions),
        )


@dataclass
class CertificateFooter(Fieldset):
    &#34;&#34;&#34;Footer fields and signature for the certificate&#34;&#34;&#34;

    reserved: _FIELD.ReservedField = _FIELD.ReservedField.factory
    ca_pubkey: _FIELD.CAPublicKeyField = _FIELD.CAPublicKeyField.factory
    signature: _FIELD.SignatureField = _FIELD.SignatureField.factory

    DECODE_ORDER = [&#34;reserved&#34;, &#34;ca_pubkey&#34;, &#34;signature&#34;]

    def __bytes__(self):
        return concat_to_bytestring(bytes(self.reserved), bytes(self.ca_pubkey))


class SSHCertificate:
    &#34;&#34;&#34;
    General class for SSH Certificates, used for loading and parsing.
    To create new certificates, use the respective keytype classes
    or the from_public_key classmethod
    &#34;&#34;&#34;

    DEFAULT_KEY_TYPE = &#34;none@openssh.com&#34;

    # pylint: disable=too-many-arguments
    def __init__(
        self,
        subject_pubkey: PublicKey = None,
        ca_privkey: PrivateKey = None,
        fields: CertificateFields = CertificateFields,
        header: CertificateHeader = CertificateHeader,
        footer: CertificateFooter = CertificateFooter,
    ):
        if self.__class__.__name__ == &#34;SSHCertificate&#34;:
            raise _EX.InvalidClassCallException(
                &#34;You cannot instantiate SSHCertificate directly. Use \n&#34;
                + &#34;one of the child classes, or call via decode, create \n&#34;
                + &#34;or one of the from_-classmethods&#34;
            )

        self.fields = fields() if isinstance(fields, type) else fields
        self.header = header() if isinstance(header, type) else header
        self.footer = footer() if isinstance(footer, type) else footer

        if isinstance(header, type) and subject_pubkey is not None:
            self.header.pubkey_type = self.DEFAULT_KEY_TYPE
            self.header.replace_field(
                &#34;public_key&#34;, _FIELD.PublicKeyField.from_object(subject_pubkey)
            )

        if isinstance(footer, type) and ca_privkey is not None:
            self.footer.ca_pubkey = ca_privkey.public_key
            self.footer.replace_field(
                &#34;signature&#34;, _FIELD.SignatureField.from_object(ca_privkey)
            )

        self.__post_init__()

    def __post_init__(self):
        &#34;&#34;&#34;Extensible function for post-initialization for child classes&#34;&#34;&#34;

    def __bytes__(self):
        if not self.footer.signature.is_signed:
            raise _EX.InvalidCertificateFormatException(
                &#34;Failed exporting certificate: Certificate is not signed&#34;
            )

        return concat_to_bytestring(
            bytes(self.header),
            bytes(self.fields),
            bytes(self.footer),
            bytes(self.footer.signature),
        )

    def __str__(self) -&gt; str:
        table = PrettyTable([&#34;Field&#34;, &#34;Value&#34;])

        for item in (self.header, self.fields, self.footer):
            for row in item.__table__():
                table.add_row(row)

        return str(table)

    @classmethod
    def create(
        cls,
        subject_pubkey: PublicKey = None,
        ca_privkey: PrivateKey = None,
        fields: CertificateFields = CertificateFields,
        header: CertificateHeader = CertificateHeader,
        footer: CertificateFooter = CertificateFooter,
    ) -&gt; &#34;SSHCertificate&#34;:
        &#34;&#34;&#34;
        Creates a new certificate from the given parameters.

        Args:
            subject_pubkey (PublicKey, optional): The subject public key. Defaults to None.
            ca_privkey (PrivateKey, optional): The CA private key. Defaults to None.
            fields (CertificateFields, optional): The CertificateFields object containing the
                body fields. Defaults to blank CertificateFields.
            header (CertificateHeader, optional): The certificate header.
                Defaults to new CertificateHeader.
            footer (CertificateFooter, optional): The certificate footer.
                Defaults to new CertificateFooter.

        Returns:
            SSHCertificate: A SSHCertificate subclass depending on the type of subject_pubkey
        &#34;&#34;&#34;
        cert_class = subject_pubkey.__class__.__name__.replace(
            &#34;PublicKey&#34;, &#34;Certificate&#34;
        )
        return globals()[cert_class](
            subject_pubkey=subject_pubkey,
            ca_privkey=ca_privkey,
            fields=fields,
            header=header,
            footer=footer,
        )

    @classmethod
    def decode(cls, data: bytes) -&gt; &#34;SSHCertificate&#34;:
        &#34;&#34;&#34;
        Decode an existing certificate and import it into a new object

        Args:
            data (bytes): The certificate bytes, base64 decoded middle part of the certificate

        Returns:
            SSHCertificate: SSHCertificate child class
        &#34;&#34;&#34;
        cert_header, data = CertificateHeader.decode(data)
        cert_fields, data = CertificateFields.decode(data)
        cert_footer, data = CertificateFooter.decode(data)

        return cls(header=cert_header, fields=cert_fields, footer=cert_footer)

    @classmethod
    def from_bytes(cls, cert_bytes: bytes):
        &#34;&#34;&#34;
        Loads an existing certificate from the byte value.

        Args:
            cert_bytes (bytes): Certificate bytes, base64 decoded middle part of the certificate

        Returns:
            SSHCertificate: SSHCertificate child class
        &#34;&#34;&#34;
        cert_type, _ = _FIELD.StringField.decode(cert_bytes)
        target_class = CERT_TYPES[cert_type]
        return globals()[target_class[0]].decode(cert_bytes)

    @classmethod
    def from_string(cls, cert_str: Union[str, bytes], encoding: str = &#34;utf-8&#34;):
        &#34;&#34;&#34;
        Loads an existing certificate from a string in the format
        [certificate-type] [base64-encoded-certificate] [optional-comment]

        Args:
            cert_str (str): The string containing the certificate
            encoding (str, optional): The encoding of the string. Defaults to &#39;utf-8&#39;.

        Returns:
            SSHCertificate: SSHCertificate child class
        &#34;&#34;&#34;
        cert_str = ensure_bytestring(cert_str, encoding)

        certificate = b64decode(cert_str.split(b&#34; &#34;)[1])
        return cls.from_bytes(cert_bytes=certificate)

    @classmethod
    def from_file(cls, path: str, encoding: str = &#34;utf-8&#34;):
        &#34;&#34;&#34;
        Loads an existing certificate from a file

        Args:
            path (str): The path to the certificate file
            encoding (str, optional): Encoding of the file. Defaults to &#39;utf-8&#39;.

        Returns:
            SSHCertificate: SSHCertificate child class
        &#34;&#34;&#34;
        with open(path, &#34;r&#34;, encoding=encoding) as file:
            return cls.from_string(file.read())

    def get(self, field: str):
        &#34;&#34;&#34;
        Fetch a field from any of the sections of the certificate.

        Args:
            field (str): The field name to fetch

        Raises:
            _EX.InvalidCertificateFieldException: Invalid field name provided

        Returns:
            mixed: The certificate field contents
        &#34;&#34;&#34;
        if field in (
            self.header.getattrs() + self.fields.getattrs() + self.footer.getattrs()
        ):
            return (
                self.fields.get(field, False)
                or self.header.get(field, False)
                or self.footer.get(field, False)
            )

        raise _EX.InvalidCertificateFieldException(f&#34;Unknown field {field}&#34;)

    def set(self, field: str, value) -&gt; None:
        &#34;&#34;&#34;
        Set a field in any of the sections of the certificate.

        Args:
            field (str): The field name to set
            value (mixed): The value to set the field to

        Raises:
            _EX.InvalidCertificateFieldException: Invalid field name provided

        Returns:
            mixed: The certificate field contents
        &#34;&#34;&#34;
        if self.fields.get(field, False):
            setattr(self.fields, field, value)
            return

        if self.header.get(field, False):
            setattr(self.header, field, value)
            return

        if self.footer.get(field, False):
            setattr(self.footer, field, value)
            return

        raise _EX.InvalidCertificateFieldException(f&#34;Unknown field {field}&#34;)

    def replace_ca(self, ca_privkey: PrivateKey):
        &#34;&#34;&#34;
        Replace the certificate authority private key with a new one.

        Args:
            ca_privkey (PrivateKey): The new CA private key
        &#34;&#34;&#34;
        self.footer.ca_pubkey = ca_privkey.public_key
        self.footer.replace_field(
            &#34;signature&#34;, _FIELD.SignatureField.from_object(ca_privkey)
        )

    def can_sign(self) -&gt; bool:
        &#34;&#34;&#34;
        Check if the certificate can be signed in its current state.

        Raises:
            _EX.SignatureNotPossibleException: Exception if the certificate cannot be signed

        Returns:
            bool: True if the certificate can be signed
        &#34;&#34;&#34;
        valid_header = self.header.validate()
        valid_fields = self.fields.validate()
        check_keys = (
            True
            if isinstance(self.get(&#34;ca_pubkey&#34;), PublicKey)
            and isinstance(self.footer.signature.private_key, PrivateKey)
            else [
                _EX.SignatureNotPossibleException(&#34;No CA Public/Private key is loaded&#34;)
            ]
        )

        if (valid_header, valid_fields, check_keys) != (True, True, True):
            exceptions = []
            exceptions += valid_header if not isinstance(valid_header, bool) else []
            exceptions += valid_fields if not isinstance(valid_fields, bool) else []
            exceptions += check_keys if not isinstance(check_keys, bool) else []
            raise _EX.SignatureNotPossibleException(
                &#34;\n&#34;.join([str(e) for e in exceptions])
            )

        return True

    def get_signable(self) -&gt; bytes:
        &#34;&#34;&#34;
        Retrieves the signable data for the certificate in byte form
        &#34;&#34;&#34;
        return concat_to_bytestring(
            bytes(self.header), bytes(self.fields), bytes(self.footer)
        )

    def sign(self) -&gt; bool:
        &#34;&#34;&#34;Sign the certificate

        Raises:
            _EX.NotSignedException: The certificate could not be signed

        Returns:
            bool: Whether successful
        &#34;&#34;&#34;
        if self.can_sign():
            self.footer.signature.sign(data=self.get_signable())

            return True
        raise _EX.NotSignedException(&#34;There was an error while signing the certificate&#34;)

    def verify(
        self, public_key: PublicKey = None, raise_on_error: bool = False
    ) -&gt; bool:
        &#34;&#34;&#34;Verify the signature on the certificate to make sure the data is not corrupted,
           and that the signature comes from the given public key or the key included in the
           certificate (insecure, useful for testing only)

        Args:
            public_key (PublicKey, optional): The public key to use for verification
            raise_on_error (bool, default False): Raise an exception if the certificate is invalid

        Raises:
            _EX.InvalidSignatureException: The signature is invalid
        &#34;&#34;&#34;
        if not public_key:
            public_key = self.get(&#34;ca_pubkey&#34;)

        try:
            public_key.verify(self.get_signable(), self.footer.get(&#34;signature&#34;))
        except _EX.InvalidSignatureException as exception:
            if raise_on_error:
                raise exception
            return False

        return True

    def to_string(self, comment: str = &#34;&#34;, encoding: str = &#34;utf-8&#34;):
        &#34;&#34;&#34;Export the certificate to a string

        Args:
            comment (str, optional): Comment to append to the certificate. Defaults to &#34;&#34;.
            encoding (str, optional): Which encoding to use for the string. Defaults to &#34;utf-8&#34;.

        Returns:
            str: The certificate data, base64-encoded and in string format
        &#34;&#34;&#34;
        return concat_to_string(
            self.header.get(&#34;pubkey_type&#34;),
            &#34; &#34;,
            b64encode(bytes(self)),
            &#34; &#34;,
            comment if comment else &#34;&#34;,
            encoding=encoding,
        )

    def to_file(self, filename: str, encoding: str = &#34;utf-8&#34;):
        &#34;&#34;&#34;Export certificate to file

        Args:
            filename (str): The filename to write to
            encoding (str, optional): The encoding to use for the file/string. Defaults to &#34;utf-8&#34;.
        &#34;&#34;&#34;
        with open(filename, &#34;w&#34;, encoding=encoding) as file:
            file.write(self.to_string())


class RsaCertificate(SSHCertificate):
    &#34;&#34;&#34;The RSA Certificate class&#34;&#34;&#34;

    DEFAULT_KEY_TYPE = &#34;rsa-sha2-512-cert-v01@openssh.com&#34;


class DsaCertificate(SSHCertificate):
    &#34;&#34;&#34;The DSA Certificate class&#34;&#34;&#34;

    DEFAULT_KEY_TYPE = &#34;ssh-dss-cert-v01@openssh.com&#34;


class EcdsaCertificate(SSHCertificate):
    &#34;&#34;&#34;The ECDSA certificate class&#34;&#34;&#34;

    DEFAULT_KEY_TYPE = &#34;ecdsa-sha2-nistp[curve_size]-cert-v01@openssh.com&#34;

    def __post_init__(self):
        &#34;&#34;&#34;Set the key name from the public key curve size&#34;&#34;&#34;
        self.header.pubkey_type = self.header.get(&#34;pubkey_type&#34;).replace(
            &#34;[curve_size]&#34;, str(self.header.public_key.value.key.curve.key_size)
        )


class Ed25519Certificate(SSHCertificate):
    &#34;&#34;&#34;The ED25519 certificate class&#34;&#34;&#34;

    DEFAULT_KEY_TYPE = &#34;ssh-ed25519-cert-v01@openssh.com&#34;</code></pre>
</details>
</section>
<section>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="sshkey_tools.cert.CertificateFields"><code class="flex name class">
<span>class <span class="ident">CertificateFields</span></span>
<span>(</span><span>serial: <a title="sshkey_tools.fields.SerialField" href="fields.html#sshkey_tools.fields.SerialField">SerialField</a> = &lt;bound method CertificateField.factory of &lt;class &#x27;sshkey_tools.fields.SerialField&#x27;&gt;&gt;, cert_type: <a title="sshkey_tools.fields.CertificateTypeField" href="fields.html#sshkey_tools.fields.CertificateTypeField">CertificateTypeField</a> = &lt;bound method CertificateField.factory of &lt;class &#x27;sshkey_tools.fields.CertificateTypeField&#x27;&gt;&gt;, key_id: <a title="sshkey_tools.fields.KeyIdField" href="fields.html#sshkey_tools.fields.KeyIdField">KeyIdField</a> = &lt;bound method CertificateField.factory of &lt;class &#x27;sshkey_tools.fields.KeyIdField&#x27;&gt;&gt;, principals: <a title="sshkey_tools.fields.PrincipalsField" href="fields.html#sshkey_tools.fields.PrincipalsField">PrincipalsField</a> = &lt;bound method CertificateField.factory of &lt;class &#x27;sshkey_tools.fields.PrincipalsField&#x27;&gt;&gt;, valid_after: <a title="sshkey_tools.fields.ValidAfterField" href="fields.html#sshkey_tools.fields.ValidAfterField">ValidAfterField</a> = &lt;bound method CertificateField.factory of &lt;class &#x27;sshkey_tools.fields.ValidAfterField&#x27;&gt;&gt;, valid_before: <a title="sshkey_tools.fields.ValidBeforeField" href="fields.html#sshkey_tools.fields.ValidBeforeField">ValidBeforeField</a> = &lt;bound method CertificateField.factory of &lt;class &#x27;sshkey_tools.fields.ValidBeforeField&#x27;&gt;&gt;, critical_options: <a title="sshkey_tools.fields.CriticalOptionsField" href="fields.html#sshkey_tools.fields.CriticalOptionsField">CriticalOptionsField</a> = &lt;bound method CertificateField.factory of &lt;class &#x27;sshkey_tools.fields.CriticalOptionsField&#x27;&gt;&gt;, extensions: <a title="sshkey_tools.fields.ExtensionsField" href="fields.html#sshkey_tools.fields.ExtensionsField">ExtensionsField</a> = &lt;bound method CertificateField.factory of &lt;class &#x27;sshkey_tools.fields.ExtensionsField&#x27;&gt;&gt;)</span>
</code></dt>
<dd>
<div class="desc"><p>Information fields for the certificate</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@dataclass
# pylint: disable=too-many-instance-attributes
class CertificateFields(Fieldset):
    &#34;&#34;&#34;Information fields for the certificate&#34;&#34;&#34;

    serial: _FIELD.SerialField = _FIELD.SerialField.factory
    cert_type: _FIELD.CertificateTypeField = _FIELD.CertificateTypeField.factory
    key_id: _FIELD.KeyIdField = _FIELD.KeyIdField.factory
    principals: _FIELD.PrincipalsField = _FIELD.PrincipalsField.factory
    valid_after: _FIELD.ValidAfterField = _FIELD.ValidAfterField.factory
    valid_before: _FIELD.ValidBeforeField = _FIELD.ValidBeforeField.factory
    critical_options: _FIELD.CriticalOptionsField = _FIELD.CriticalOptionsField.factory
    extensions: _FIELD.ExtensionsField = _FIELD.ExtensionsField.factory

    DECODE_ORDER = [
        &#34;serial&#34;,
        &#34;cert_type&#34;,
        &#34;key_id&#34;,
        &#34;principals&#34;,
        &#34;valid_after&#34;,
        &#34;valid_before&#34;,
        &#34;critical_options&#34;,
        &#34;extensions&#34;,
    ]

    def __bytes__(self):
        return concat_to_bytestring(
            bytes(self.serial),
            bytes(self.cert_type),
            bytes(self.key_id),
            bytes(self.principals),
            bytes(self.valid_after),
            bytes(self.valid_before),
            bytes(self.critical_options),
            bytes(self.extensions),
        )</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="sshkey_tools.cert.Fieldset" href="#sshkey_tools.cert.Fieldset">Fieldset</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="sshkey_tools.cert.CertificateFields.DECODE_ORDER"><code class="name">var <span class="ident">DECODE_ORDER</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
</dl>
<h3>Static methods</h3>
<dl>
<dt id="sshkey_tools.cert.CertificateFields.cert_type"><code class="name flex">
<span>def <span class="ident">cert_type</span></span>(<span>blank: bool = False) ‑> <a title="sshkey_tools.fields.CertificateField" href="fields.html#sshkey_tools.fields.CertificateField">CertificateField</a></span>
</code></dt>
<dd>
<div class="desc"><p>Factory to create field with default value if set, otherwise empty</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>blank</code></strong> :&ensp;<code>bool</code></dt>
<dd>Return a blank class (for decoding)</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>CertificateField</code></dt>
<dd>A new CertificateField subclass instance</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@classmethod
# pylint: disable=not-callable
def factory(cls, blank: bool = False) -&gt; &#34;CertificateField&#34;:
    &#34;&#34;&#34;
    Factory to create field with default value if set, otherwise empty

    Args:
        blank (bool): Return a blank class (for decoding)

    Returns:
        CertificateField: A new CertificateField subclass instance
    &#34;&#34;&#34;
    if cls.DEFAULT is None or blank:
        return cls

    if callable(cls.DEFAULT):
        return cls(cls.DEFAULT())

    return cls(cls.DEFAULT)</code></pre>
</details>
</dd>
<dt id="sshkey_tools.cert.CertificateFields.critical_options"><code class="name flex">
<span>def <span class="ident">critical_options</span></span>(<span>blank: bool = False) ‑> <a title="sshkey_tools.fields.CertificateField" href="fields.html#sshkey_tools.fields.CertificateField">CertificateField</a></span>
</code></dt>
<dd>
<div class="desc"><p>Factory to create field with default value if set, otherwise empty</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>blank</code></strong> :&ensp;<code>bool</code></dt>
<dd>Return a blank class (for decoding)</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>CertificateField</code></dt>
<dd>A new CertificateField subclass instance</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@classmethod
# pylint: disable=not-callable
def factory(cls, blank: bool = False) -&gt; &#34;CertificateField&#34;:
    &#34;&#34;&#34;
    Factory to create field with default value if set, otherwise empty

    Args:
        blank (bool): Return a blank class (for decoding)

    Returns:
        CertificateField: A new CertificateField subclass instance
    &#34;&#34;&#34;
    if cls.DEFAULT is None or blank:
        return cls

    if callable(cls.DEFAULT):
        return cls(cls.DEFAULT())

    return cls(cls.DEFAULT)</code></pre>
</details>
</dd>
<dt id="sshkey_tools.cert.CertificateFields.extensions"><code class="name flex">
<span>def <span class="ident">extensions</span></span>(<span>blank: bool = False) ‑> <a title="sshkey_tools.fields.CertificateField" href="fields.html#sshkey_tools.fields.CertificateField">CertificateField</a></span>
</code></dt>
<dd>
<div class="desc"><p>Factory to create field with default value if set, otherwise empty</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>blank</code></strong> :&ensp;<code>bool</code></dt>
<dd>Return a blank class (for decoding)</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>CertificateField</code></dt>
<dd>A new CertificateField subclass instance</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@classmethod
# pylint: disable=not-callable
def factory(cls, blank: bool = False) -&gt; &#34;CertificateField&#34;:
    &#34;&#34;&#34;
    Factory to create field with default value if set, otherwise empty

    Args:
        blank (bool): Return a blank class (for decoding)

    Returns:
        CertificateField: A new CertificateField subclass instance
    &#34;&#34;&#34;
    if cls.DEFAULT is None or blank:
        return cls

    if callable(cls.DEFAULT):
        return cls(cls.DEFAULT())

    return cls(cls.DEFAULT)</code></pre>
</details>
</dd>
<dt id="sshkey_tools.cert.CertificateFields.key_id"><code class="name flex">
<span>def <span class="ident">key_id</span></span>(<span>blank: bool = False) ‑> <a title="sshkey_tools.fields.CertificateField" href="fields.html#sshkey_tools.fields.CertificateField">CertificateField</a></span>
</code></dt>
<dd>
<div class="desc"><p>Factory to create field with default value if set, otherwise empty</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>blank</code></strong> :&ensp;<code>bool</code></dt>
<dd>Return a blank class (for decoding)</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>CertificateField</code></dt>
<dd>A new CertificateField subclass instance</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@classmethod
# pylint: disable=not-callable
def factory(cls, blank: bool = False) -&gt; &#34;CertificateField&#34;:
    &#34;&#34;&#34;
    Factory to create field with default value if set, otherwise empty

    Args:
        blank (bool): Return a blank class (for decoding)

    Returns:
        CertificateField: A new CertificateField subclass instance
    &#34;&#34;&#34;
    if cls.DEFAULT is None or blank:
        return cls

    if callable(cls.DEFAULT):
        return cls(cls.DEFAULT())

    return cls(cls.DEFAULT)</code></pre>
</details>
</dd>
<dt id="sshkey_tools.cert.CertificateFields.principals"><code class="name flex">
<span>def <span class="ident">principals</span></span>(<span>blank: bool = False) ‑> <a title="sshkey_tools.fields.CertificateField" href="fields.html#sshkey_tools.fields.CertificateField">CertificateField</a></span>
</code></dt>
<dd>
<div class="desc"><p>Factory to create field with default value if set, otherwise empty</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>blank</code></strong> :&ensp;<code>bool</code></dt>
<dd>Return a blank class (for decoding)</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>CertificateField</code></dt>
<dd>A new CertificateField subclass instance</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@classmethod
# pylint: disable=not-callable
def factory(cls, blank: bool = False) -&gt; &#34;CertificateField&#34;:
    &#34;&#34;&#34;
    Factory to create field with default value if set, otherwise empty

    Args:
        blank (bool): Return a blank class (for decoding)

    Returns:
        CertificateField: A new CertificateField subclass instance
    &#34;&#34;&#34;
    if cls.DEFAULT is None or blank:
        return cls

    if callable(cls.DEFAULT):
        return cls(cls.DEFAULT())

    return cls(cls.DEFAULT)</code></pre>
</details>
</dd>
<dt id="sshkey_tools.cert.CertificateFields.serial"><code class="name flex">
<span>def <span class="ident">serial</span></span>(<span>blank: bool = False) ‑> <a title="sshkey_tools.fields.CertificateField" href="fields.html#sshkey_tools.fields.CertificateField">CertificateField</a></span>
</code></dt>
<dd>
<div class="desc"><p>Factory to create field with default value if set, otherwise empty</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>blank</code></strong> :&ensp;<code>bool</code></dt>
<dd>Return a blank class (for decoding)</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>CertificateField</code></dt>
<dd>A new CertificateField subclass instance</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@classmethod
# pylint: disable=not-callable
def factory(cls, blank: bool = False) -&gt; &#34;CertificateField&#34;:
    &#34;&#34;&#34;
    Factory to create field with default value if set, otherwise empty

    Args:
        blank (bool): Return a blank class (for decoding)

    Returns:
        CertificateField: A new CertificateField subclass instance
    &#34;&#34;&#34;
    if cls.DEFAULT is None or blank:
        return cls

    if callable(cls.DEFAULT):
        return cls(cls.DEFAULT())

    return cls(cls.DEFAULT)</code></pre>
</details>
</dd>
<dt id="sshkey_tools.cert.CertificateFields.valid_after"><code class="name flex">
<span>def <span class="ident">valid_after</span></span>(<span>blank: bool = False) ‑> <a title="sshkey_tools.fields.CertificateField" href="fields.html#sshkey_tools.fields.CertificateField">CertificateField</a></span>
</code></dt>
<dd>
<div class="desc"><p>Factory to create field with default value if set, otherwise empty</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>blank</code></strong> :&ensp;<code>bool</code></dt>
<dd>Return a blank class (for decoding)</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>CertificateField</code></dt>
<dd>A new CertificateField subclass instance</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@classmethod
# pylint: disable=not-callable
def factory(cls, blank: bool = False) -&gt; &#34;CertificateField&#34;:
    &#34;&#34;&#34;
    Factory to create field with default value if set, otherwise empty

    Args:
        blank (bool): Return a blank class (for decoding)

    Returns:
        CertificateField: A new CertificateField subclass instance
    &#34;&#34;&#34;
    if cls.DEFAULT is None or blank:
        return cls

    if callable(cls.DEFAULT):
        return cls(cls.DEFAULT())

    return cls(cls.DEFAULT)</code></pre>
</details>
</dd>
<dt id="sshkey_tools.cert.CertificateFields.valid_before"><code class="name flex">
<span>def <span class="ident">valid_before</span></span>(<span>blank: bool = False) ‑> <a title="sshkey_tools.fields.CertificateField" href="fields.html#sshkey_tools.fields.CertificateField">CertificateField</a></span>
</code></dt>
<dd>
<div class="desc"><p>Factory to create field with default value if set, otherwise empty</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>blank</code></strong> :&ensp;<code>bool</code></dt>
<dd>Return a blank class (for decoding)</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>CertificateField</code></dt>
<dd>A new CertificateField subclass instance</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@classmethod
# pylint: disable=not-callable
def factory(cls, blank: bool = False) -&gt; &#34;CertificateField&#34;:
    &#34;&#34;&#34;
    Factory to create field with default value if set, otherwise empty

    Args:
        blank (bool): Return a blank class (for decoding)

    Returns:
        CertificateField: A new CertificateField subclass instance
    &#34;&#34;&#34;
    if cls.DEFAULT is None or blank:
        return cls

    if callable(cls.DEFAULT):
        return cls(cls.DEFAULT())

    return cls(cls.DEFAULT)</code></pre>
</details>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="sshkey_tools.cert.Fieldset" href="#sshkey_tools.cert.Fieldset">Fieldset</a></b></code>:
<ul class="hlist">
<li><code><a title="sshkey_tools.cert.Fieldset.decode" href="#sshkey_tools.cert.Fieldset.decode">decode</a></code></li>
<li><code><a title="sshkey_tools.cert.Fieldset.get" href="#sshkey_tools.cert.Fieldset.get">get</a></code></li>
<li><code><a title="sshkey_tools.cert.Fieldset.getattrs" href="#sshkey_tools.cert.Fieldset.getattrs">getattrs</a></code></li>
<li><code><a title="sshkey_tools.cert.Fieldset.replace_field" href="#sshkey_tools.cert.Fieldset.replace_field">replace_field</a></code></li>
<li><code><a title="sshkey_tools.cert.Fieldset.validate" href="#sshkey_tools.cert.Fieldset.validate">validate</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="sshkey_tools.cert.CertificateFooter"><code class="flex name class">
<span>class <span class="ident">CertificateFooter</span></span>
<span>(</span><span>reserved: <a title="sshkey_tools.fields.ReservedField" href="fields.html#sshkey_tools.fields.ReservedField">ReservedField</a> = &lt;bound method CertificateField.factory of &lt;class &#x27;sshkey_tools.fields.ReservedField&#x27;&gt;&gt;, ca_pubkey: <a title="sshkey_tools.fields.CAPublicKeyField" href="fields.html#sshkey_tools.fields.CAPublicKeyField">CAPublicKeyField</a> = &lt;bound method CertificateField.factory of &lt;class &#x27;sshkey_tools.fields.CAPublicKeyField&#x27;&gt;&gt;, signature: <a title="sshkey_tools.fields.SignatureField" href="fields.html#sshkey_tools.fields.SignatureField">SignatureField</a> = &lt;bound method CertificateField.factory of &lt;class &#x27;sshkey_tools.fields.SignatureField&#x27;&gt;&gt;)</span>
</code></dt>
<dd>
<div class="desc"><p>Footer fields and signature for the certificate</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@dataclass
class CertificateFooter(Fieldset):
    &#34;&#34;&#34;Footer fields and signature for the certificate&#34;&#34;&#34;

    reserved: _FIELD.ReservedField = _FIELD.ReservedField.factory
    ca_pubkey: _FIELD.CAPublicKeyField = _FIELD.CAPublicKeyField.factory
    signature: _FIELD.SignatureField = _FIELD.SignatureField.factory

    DECODE_ORDER = [&#34;reserved&#34;, &#34;ca_pubkey&#34;, &#34;signature&#34;]

    def __bytes__(self):
        return concat_to_bytestring(bytes(self.reserved), bytes(self.ca_pubkey))</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="sshkey_tools.cert.Fieldset" href="#sshkey_tools.cert.Fieldset">Fieldset</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="sshkey_tools.cert.CertificateFooter.DECODE_ORDER"><code class="name">var <span class="ident">DECODE_ORDER</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
</dl>
<h3>Static methods</h3>
<dl>
<dt id="sshkey_tools.cert.CertificateFooter.ca_pubkey"><code class="name flex">
<span>def <span class="ident">ca_pubkey</span></span>(<span>blank: bool = False) ‑> <a title="sshkey_tools.fields.CertificateField" href="fields.html#sshkey_tools.fields.CertificateField">CertificateField</a></span>
</code></dt>
<dd>
<div class="desc"><p>Factory to create field with default value if set, otherwise empty</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>blank</code></strong> :&ensp;<code>bool</code></dt>
<dd>Return a blank class (for decoding)</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>CertificateField</code></dt>
<dd>A new CertificateField subclass instance</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@classmethod
# pylint: disable=not-callable
def factory(cls, blank: bool = False) -&gt; &#34;CertificateField&#34;:
    &#34;&#34;&#34;
    Factory to create field with default value if set, otherwise empty

    Args:
        blank (bool): Return a blank class (for decoding)

    Returns:
        CertificateField: A new CertificateField subclass instance
    &#34;&#34;&#34;
    if cls.DEFAULT is None or blank:
        return cls

    if callable(cls.DEFAULT):
        return cls(cls.DEFAULT())

    return cls(cls.DEFAULT)</code></pre>
</details>
</dd>
<dt id="sshkey_tools.cert.CertificateFooter.reserved"><code class="name flex">
<span>def <span class="ident">reserved</span></span>(<span>blank: bool = False) ‑> <a title="sshkey_tools.fields.CertificateField" href="fields.html#sshkey_tools.fields.CertificateField">CertificateField</a></span>
</code></dt>
<dd>
<div class="desc"><p>Factory to create field with default value if set, otherwise empty</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>blank</code></strong> :&ensp;<code>bool</code></dt>
<dd>Return a blank class (for decoding)</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>CertificateField</code></dt>
<dd>A new CertificateField subclass instance</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@classmethod
# pylint: disable=not-callable
def factory(cls, blank: bool = False) -&gt; &#34;CertificateField&#34;:
    &#34;&#34;&#34;
    Factory to create field with default value if set, otherwise empty

    Args:
        blank (bool): Return a blank class (for decoding)

    Returns:
        CertificateField: A new CertificateField subclass instance
    &#34;&#34;&#34;
    if cls.DEFAULT is None or blank:
        return cls

    if callable(cls.DEFAULT):
        return cls(cls.DEFAULT())

    return cls(cls.DEFAULT)</code></pre>
</details>
</dd>
<dt id="sshkey_tools.cert.CertificateFooter.signature"><code class="name flex">
<span>def <span class="ident">signature</span></span>(<span>blank: bool = False) ‑> <a title="sshkey_tools.fields.CertificateField" href="fields.html#sshkey_tools.fields.CertificateField">CertificateField</a></span>
</code></dt>
<dd>
<div class="desc"><p>Factory to create field with default value if set, otherwise empty</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>blank</code></strong> :&ensp;<code>bool</code></dt>
<dd>Return a blank class (for decoding)</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>CertificateField</code></dt>
<dd>A new CertificateField subclass instance</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@classmethod
# pylint: disable=not-callable
def factory(cls, blank: bool = False) -&gt; &#34;CertificateField&#34;:
    &#34;&#34;&#34;
    Factory to create field with default value if set, otherwise empty

    Args:
        blank (bool): Return a blank class (for decoding)

    Returns:
        CertificateField: A new CertificateField subclass instance
    &#34;&#34;&#34;
    if cls.DEFAULT is None or blank:
        return cls

    if callable(cls.DEFAULT):
        return cls(cls.DEFAULT())

    return cls(cls.DEFAULT)</code></pre>
</details>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="sshkey_tools.cert.Fieldset" href="#sshkey_tools.cert.Fieldset">Fieldset</a></b></code>:
<ul class="hlist">
<li><code><a title="sshkey_tools.cert.Fieldset.decode" href="#sshkey_tools.cert.Fieldset.decode">decode</a></code></li>
<li><code><a title="sshkey_tools.cert.Fieldset.get" href="#sshkey_tools.cert.Fieldset.get">get</a></code></li>
<li><code><a title="sshkey_tools.cert.Fieldset.getattrs" href="#sshkey_tools.cert.Fieldset.getattrs">getattrs</a></code></li>
<li><code><a title="sshkey_tools.cert.Fieldset.replace_field" href="#sshkey_tools.cert.Fieldset.replace_field">replace_field</a></code></li>
<li><code><a title="sshkey_tools.cert.Fieldset.validate" href="#sshkey_tools.cert.Fieldset.validate">validate</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="sshkey_tools.cert.CertificateHeader"><code class="flex name class">
<span>class <span class="ident">CertificateHeader</span></span>
<span>(</span><span>public_key: <a title="sshkey_tools.fields.PublicKeyField" href="fields.html#sshkey_tools.fields.PublicKeyField">PublicKeyField</a> = &lt;bound method CertificateField.factory of &lt;class &#x27;sshkey_tools.fields.PublicKeyField&#x27;&gt;&gt;, pubkey_type: <a title="sshkey_tools.fields.PubkeyTypeField" href="fields.html#sshkey_tools.fields.PubkeyTypeField">PubkeyTypeField</a> = &lt;bound method CertificateField.factory of &lt;class &#x27;sshkey_tools.fields.PubkeyTypeField&#x27;&gt;&gt;, nonce: <a title="sshkey_tools.fields.NonceField" href="fields.html#sshkey_tools.fields.NonceField">NonceField</a> = &lt;bound method CertificateField.factory of &lt;class &#x27;sshkey_tools.fields.NonceField&#x27;&gt;&gt;)</span>
</code></dt>
<dd>
<div class="desc"><p>Header fields for the certificate</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@dataclass
class CertificateHeader(Fieldset):
    &#34;&#34;&#34;Header fields for the certificate&#34;&#34;&#34;

    public_key: _FIELD.PublicKeyField = _FIELD.PublicKeyField.factory
    pubkey_type: _FIELD.PubkeyTypeField = _FIELD.PubkeyTypeField.factory
    nonce: _FIELD.NonceField = _FIELD.NonceField.factory

    DECODE_ORDER = [&#34;pubkey_type&#34;, &#34;nonce&#34;]

    def __bytes__(self):
        return concat_to_bytestring(
            bytes(self.pubkey_type), bytes(self.nonce), bytes(self.public_key)
        )

    @classmethod
    def decode(cls, data: bytes) -&gt; Tuple[&#34;CertificateHeader&#34;, bytes]:
        cl_instance, data = super().decode(data)

        target_class = CERT_TYPES[cl_instance.get(&#34;pubkey_type&#34;)]

        public_key, data = getattr(_FIELD, target_class[1]).from_decode(data)
        cl_instance.public_key = public_key

        return cl_instance, data</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="sshkey_tools.cert.Fieldset" href="#sshkey_tools.cert.Fieldset">Fieldset</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="sshkey_tools.cert.CertificateHeader.DECODE_ORDER"><code class="name">var <span class="ident">DECODE_ORDER</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
</dl>
<h3>Static methods</h3>
<dl>
<dt id="sshkey_tools.cert.CertificateHeader.nonce"><code class="name flex">
<span>def <span class="ident">nonce</span></span>(<span>blank: bool = False) ‑> <a title="sshkey_tools.fields.CertificateField" href="fields.html#sshkey_tools.fields.CertificateField">CertificateField</a></span>
</code></dt>
<dd>
<div class="desc"><p>Factory to create field with default value if set, otherwise empty</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>blank</code></strong> :&ensp;<code>bool</code></dt>
<dd>Return a blank class (for decoding)</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>CertificateField</code></dt>
<dd>A new CertificateField subclass instance</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@classmethod
# pylint: disable=not-callable
def factory(cls, blank: bool = False) -&gt; &#34;CertificateField&#34;:
    &#34;&#34;&#34;
    Factory to create field with default value if set, otherwise empty

    Args:
        blank (bool): Return a blank class (for decoding)

    Returns:
        CertificateField: A new CertificateField subclass instance
    &#34;&#34;&#34;
    if cls.DEFAULT is None or blank:
        return cls

    if callable(cls.DEFAULT):
        return cls(cls.DEFAULT())

    return cls(cls.DEFAULT)</code></pre>
</details>
</dd>
<dt id="sshkey_tools.cert.CertificateHeader.pubkey_type"><code class="name flex">
<span>def <span class="ident">pubkey_type</span></span>(<span>blank: bool = False) ‑> <a title="sshkey_tools.fields.CertificateField" href="fields.html#sshkey_tools.fields.CertificateField">CertificateField</a></span>
</code></dt>
<dd>
<div class="desc"><p>Factory to create field with default value if set, otherwise empty</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>blank</code></strong> :&ensp;<code>bool</code></dt>
<dd>Return a blank class (for decoding)</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>CertificateField</code></dt>
<dd>A new CertificateField subclass instance</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@classmethod
# pylint: disable=not-callable
def factory(cls, blank: bool = False) -&gt; &#34;CertificateField&#34;:
    &#34;&#34;&#34;
    Factory to create field with default value if set, otherwise empty

    Args:
        blank (bool): Return a blank class (for decoding)

    Returns:
        CertificateField: A new CertificateField subclass instance
    &#34;&#34;&#34;
    if cls.DEFAULT is None or blank:
        return cls

    if callable(cls.DEFAULT):
        return cls(cls.DEFAULT())

    return cls(cls.DEFAULT)</code></pre>
</details>
</dd>
<dt id="sshkey_tools.cert.CertificateHeader.public_key"><code class="name flex">
<span>def <span class="ident">public_key</span></span>(<span>blank: bool = False) ‑> <a title="sshkey_tools.fields.CertificateField" href="fields.html#sshkey_tools.fields.CertificateField">CertificateField</a></span>
</code></dt>
<dd>
<div class="desc"><p>Factory to create field with default value if set, otherwise empty</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>blank</code></strong> :&ensp;<code>bool</code></dt>
<dd>Return a blank class (for decoding)</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>CertificateField</code></dt>
<dd>A new CertificateField subclass instance</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@classmethod
# pylint: disable=not-callable
def factory(cls, blank: bool = False) -&gt; &#34;CertificateField&#34;:
    &#34;&#34;&#34;
    Factory to create field with default value if set, otherwise empty

    Args:
        blank (bool): Return a blank class (for decoding)

    Returns:
        CertificateField: A new CertificateField subclass instance
    &#34;&#34;&#34;
    if cls.DEFAULT is None or blank:
        return cls

    if callable(cls.DEFAULT):
        return cls(cls.DEFAULT())

    return cls(cls.DEFAULT)</code></pre>
</details>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="sshkey_tools.cert.Fieldset" href="#sshkey_tools.cert.Fieldset">Fieldset</a></b></code>:
<ul class="hlist">
<li><code><a title="sshkey_tools.cert.Fieldset.decode" href="#sshkey_tools.cert.Fieldset.decode">decode</a></code></li>
<li><code><a title="sshkey_tools.cert.Fieldset.get" href="#sshkey_tools.cert.Fieldset.get">get</a></code></li>
<li><code><a title="sshkey_tools.cert.Fieldset.getattrs" href="#sshkey_tools.cert.Fieldset.getattrs">getattrs</a></code></li>
<li><code><a title="sshkey_tools.cert.Fieldset.replace_field" href="#sshkey_tools.cert.Fieldset.replace_field">replace_field</a></code></li>
<li><code><a title="sshkey_tools.cert.Fieldset.validate" href="#sshkey_tools.cert.Fieldset.validate">validate</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="sshkey_tools.cert.DsaCertificate"><code class="flex name class">
<span>class <span class="ident">DsaCertificate</span></span>
<span>(</span><span>subject_pubkey: <a title="sshkey_tools.keys.PublicKey" href="keys.html#sshkey_tools.keys.PublicKey">PublicKey</a> = None, ca_privkey: <a title="sshkey_tools.keys.PrivateKey" href="keys.html#sshkey_tools.keys.PrivateKey">PrivateKey</a> = None, fields: <a title="sshkey_tools.cert.CertificateFields" href="#sshkey_tools.cert.CertificateFields">CertificateFields</a> = sshkey_tools.cert.CertificateFields, header: <a title="sshkey_tools.cert.CertificateHeader" href="#sshkey_tools.cert.CertificateHeader">CertificateHeader</a> = sshkey_tools.cert.CertificateHeader, footer: <a title="sshkey_tools.cert.CertificateFooter" href="#sshkey_tools.cert.CertificateFooter">CertificateFooter</a> = sshkey_tools.cert.CertificateFooter)</span>
</code></dt>
<dd>
<div class="desc"><p>The DSA Certificate class</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class DsaCertificate(SSHCertificate):
    &#34;&#34;&#34;The DSA Certificate class&#34;&#34;&#34;

    DEFAULT_KEY_TYPE = &#34;ssh-dss-cert-v01@openssh.com&#34;</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="sshkey_tools.cert.SSHCertificate" href="#sshkey_tools.cert.SSHCertificate">SSHCertificate</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="sshkey_tools.cert.DsaCertificate.DEFAULT_KEY_TYPE"><code class="name">var <span class="ident">DEFAULT_KEY_TYPE</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="sshkey_tools.cert.SSHCertificate" href="#sshkey_tools.cert.SSHCertificate">SSHCertificate</a></b></code>:
<ul class="hlist">
<li><code><a title="sshkey_tools.cert.SSHCertificate.can_sign" href="#sshkey_tools.cert.SSHCertificate.can_sign">can_sign</a></code></li>
<li><code><a title="sshkey_tools.cert.SSHCertificate.create" href="#sshkey_tools.cert.SSHCertificate.create">create</a></code></li>
<li><code><a title="sshkey_tools.cert.SSHCertificate.decode" href="#sshkey_tools.cert.SSHCertificate.decode">decode</a></code></li>
<li><code><a title="sshkey_tools.cert.SSHCertificate.from_bytes" href="#sshkey_tools.cert.SSHCertificate.from_bytes">from_bytes</a></code></li>
<li><code><a title="sshkey_tools.cert.SSHCertificate.from_file" href="#sshkey_tools.cert.SSHCertificate.from_file">from_file</a></code></li>
<li><code><a title="sshkey_tools.cert.SSHCertificate.from_string" href="#sshkey_tools.cert.SSHCertificate.from_string">from_string</a></code></li>
<li><code><a title="sshkey_tools.cert.SSHCertificate.get" href="#sshkey_tools.cert.SSHCertificate.get">get</a></code></li>
<li><code><a title="sshkey_tools.cert.SSHCertificate.get_signable" href="#sshkey_tools.cert.SSHCertificate.get_signable">get_signable</a></code></li>
<li><code><a title="sshkey_tools.cert.SSHCertificate.replace_ca" href="#sshkey_tools.cert.SSHCertificate.replace_ca">replace_ca</a></code></li>
<li><code><a title="sshkey_tools.cert.SSHCertificate.set" href="#sshkey_tools.cert.SSHCertificate.set">set</a></code></li>
<li><code><a title="sshkey_tools.cert.SSHCertificate.sign" href="#sshkey_tools.cert.SSHCertificate.sign">sign</a></code></li>
<li><code><a title="sshkey_tools.cert.SSHCertificate.to_file" href="#sshkey_tools.cert.SSHCertificate.to_file">to_file</a></code></li>
<li><code><a title="sshkey_tools.cert.SSHCertificate.to_string" href="#sshkey_tools.cert.SSHCertificate.to_string">to_string</a></code></li>
<li><code><a title="sshkey_tools.cert.SSHCertificate.verify" href="#sshkey_tools.cert.SSHCertificate.verify">verify</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="sshkey_tools.cert.EcdsaCertificate"><code class="flex name class">
<span>class <span class="ident">EcdsaCertificate</span></span>
<span>(</span><span>subject_pubkey: <a title="sshkey_tools.keys.PublicKey" href="keys.html#sshkey_tools.keys.PublicKey">PublicKey</a> = None, ca_privkey: <a title="sshkey_tools.keys.PrivateKey" href="keys.html#sshkey_tools.keys.PrivateKey">PrivateKey</a> = None, fields: <a title="sshkey_tools.cert.CertificateFields" href="#sshkey_tools.cert.CertificateFields">CertificateFields</a> = sshkey_tools.cert.CertificateFields, header: <a title="sshkey_tools.cert.CertificateHeader" href="#sshkey_tools.cert.CertificateHeader">CertificateHeader</a> = sshkey_tools.cert.CertificateHeader, footer: <a title="sshkey_tools.cert.CertificateFooter" href="#sshkey_tools.cert.CertificateFooter">CertificateFooter</a> = sshkey_tools.cert.CertificateFooter)</span>
</code></dt>
<dd>
<div class="desc"><p>The ECDSA certificate class</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class EcdsaCertificate(SSHCertificate):
    &#34;&#34;&#34;The ECDSA certificate class&#34;&#34;&#34;

    DEFAULT_KEY_TYPE = &#34;ecdsa-sha2-nistp[curve_size]-cert-v01@openssh.com&#34;

    def __post_init__(self):
        &#34;&#34;&#34;Set the key name from the public key curve size&#34;&#34;&#34;
        self.header.pubkey_type = self.header.get(&#34;pubkey_type&#34;).replace(
            &#34;[curve_size]&#34;, str(self.header.public_key.value.key.curve.key_size)
        )</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="sshkey_tools.cert.SSHCertificate" href="#sshkey_tools.cert.SSHCertificate">SSHCertificate</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="sshkey_tools.cert.EcdsaCertificate.DEFAULT_KEY_TYPE"><code class="name">var <span class="ident">DEFAULT_KEY_TYPE</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="sshkey_tools.cert.SSHCertificate" href="#sshkey_tools.cert.SSHCertificate">SSHCertificate</a></b></code>:
<ul class="hlist">
<li><code><a title="sshkey_tools.cert.SSHCertificate.can_sign" href="#sshkey_tools.cert.SSHCertificate.can_sign">can_sign</a></code></li>
<li><code><a title="sshkey_tools.cert.SSHCertificate.create" href="#sshkey_tools.cert.SSHCertificate.create">create</a></code></li>
<li><code><a title="sshkey_tools.cert.SSHCertificate.decode" href="#sshkey_tools.cert.SSHCertificate.decode">decode</a></code></li>
<li><code><a title="sshkey_tools.cert.SSHCertificate.from_bytes" href="#sshkey_tools.cert.SSHCertificate.from_bytes">from_bytes</a></code></li>
<li><code><a title="sshkey_tools.cert.SSHCertificate.from_file" href="#sshkey_tools.cert.SSHCertificate.from_file">from_file</a></code></li>
<li><code><a title="sshkey_tools.cert.SSHCertificate.from_string" href="#sshkey_tools.cert.SSHCertificate.from_string">from_string</a></code></li>
<li><code><a title="sshkey_tools.cert.SSHCertificate.get" href="#sshkey_tools.cert.SSHCertificate.get">get</a></code></li>
<li><code><a title="sshkey_tools.cert.SSHCertificate.get_signable" href="#sshkey_tools.cert.SSHCertificate.get_signable">get_signable</a></code></li>
<li><code><a title="sshkey_tools.cert.SSHCertificate.replace_ca" href="#sshkey_tools.cert.SSHCertificate.replace_ca">replace_ca</a></code></li>
<li><code><a title="sshkey_tools.cert.SSHCertificate.set" href="#sshkey_tools.cert.SSHCertificate.set">set</a></code></li>
<li><code><a title="sshkey_tools.cert.SSHCertificate.sign" href="#sshkey_tools.cert.SSHCertificate.sign">sign</a></code></li>
<li><code><a title="sshkey_tools.cert.SSHCertificate.to_file" href="#sshkey_tools.cert.SSHCertificate.to_file">to_file</a></code></li>
<li><code><a title="sshkey_tools.cert.SSHCertificate.to_string" href="#sshkey_tools.cert.SSHCertificate.to_string">to_string</a></code></li>
<li><code><a title="sshkey_tools.cert.SSHCertificate.verify" href="#sshkey_tools.cert.SSHCertificate.verify">verify</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="sshkey_tools.cert.Ed25519Certificate"><code class="flex name class">
<span>class <span class="ident">Ed25519Certificate</span></span>
<span>(</span><span>subject_pubkey: <a title="sshkey_tools.keys.PublicKey" href="keys.html#sshkey_tools.keys.PublicKey">PublicKey</a> = None, ca_privkey: <a title="sshkey_tools.keys.PrivateKey" href="keys.html#sshkey_tools.keys.PrivateKey">PrivateKey</a> = None, fields: <a title="sshkey_tools.cert.CertificateFields" href="#sshkey_tools.cert.CertificateFields">CertificateFields</a> = sshkey_tools.cert.CertificateFields, header: <a title="sshkey_tools.cert.CertificateHeader" href="#sshkey_tools.cert.CertificateHeader">CertificateHeader</a> = sshkey_tools.cert.CertificateHeader, footer: <a title="sshkey_tools.cert.CertificateFooter" href="#sshkey_tools.cert.CertificateFooter">CertificateFooter</a> = sshkey_tools.cert.CertificateFooter)</span>
</code></dt>
<dd>
<div class="desc"><p>The ED25519 certificate class</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class Ed25519Certificate(SSHCertificate):
    &#34;&#34;&#34;The ED25519 certificate class&#34;&#34;&#34;

    DEFAULT_KEY_TYPE = &#34;ssh-ed25519-cert-v01@openssh.com&#34;</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="sshkey_tools.cert.SSHCertificate" href="#sshkey_tools.cert.SSHCertificate">SSHCertificate</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="sshkey_tools.cert.Ed25519Certificate.DEFAULT_KEY_TYPE"><code class="name">var <span class="ident">DEFAULT_KEY_TYPE</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="sshkey_tools.cert.SSHCertificate" href="#sshkey_tools.cert.SSHCertificate">SSHCertificate</a></b></code>:
<ul class="hlist">
<li><code><a title="sshkey_tools.cert.SSHCertificate.can_sign" href="#sshkey_tools.cert.SSHCertificate.can_sign">can_sign</a></code></li>
<li><code><a title="sshkey_tools.cert.SSHCertificate.create" href="#sshkey_tools.cert.SSHCertificate.create">create</a></code></li>
<li><code><a title="sshkey_tools.cert.SSHCertificate.decode" href="#sshkey_tools.cert.SSHCertificate.decode">decode</a></code></li>
<li><code><a title="sshkey_tools.cert.SSHCertificate.from_bytes" href="#sshkey_tools.cert.SSHCertificate.from_bytes">from_bytes</a></code></li>
<li><code><a title="sshkey_tools.cert.SSHCertificate.from_file" href="#sshkey_tools.cert.SSHCertificate.from_file">from_file</a></code></li>
<li><code><a title="sshkey_tools.cert.SSHCertificate.from_string" href="#sshkey_tools.cert.SSHCertificate.from_string">from_string</a></code></li>
<li><code><a title="sshkey_tools.cert.SSHCertificate.get" href="#sshkey_tools.cert.SSHCertificate.get">get</a></code></li>
<li><code><a title="sshkey_tools.cert.SSHCertificate.get_signable" href="#sshkey_tools.cert.SSHCertificate.get_signable">get_signable</a></code></li>
<li><code><a title="sshkey_tools.cert.SSHCertificate.replace_ca" href="#sshkey_tools.cert.SSHCertificate.replace_ca">replace_ca</a></code></li>
<li><code><a title="sshkey_tools.cert.SSHCertificate.set" href="#sshkey_tools.cert.SSHCertificate.set">set</a></code></li>
<li><code><a title="sshkey_tools.cert.SSHCertificate.sign" href="#sshkey_tools.cert.SSHCertificate.sign">sign</a></code></li>
<li><code><a title="sshkey_tools.cert.SSHCertificate.to_file" href="#sshkey_tools.cert.SSHCertificate.to_file">to_file</a></code></li>
<li><code><a title="sshkey_tools.cert.SSHCertificate.to_string" href="#sshkey_tools.cert.SSHCertificate.to_string">to_string</a></code></li>
<li><code><a title="sshkey_tools.cert.SSHCertificate.verify" href="#sshkey_tools.cert.SSHCertificate.verify">verify</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="sshkey_tools.cert.Fieldset"><code class="flex name class">
<span>class <span class="ident">Fieldset</span></span>
</code></dt>
<dd>
<div class="desc"><p>Set of fields for SSHCertificate class</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@dataclass
class Fieldset:
    &#34;&#34;&#34;Set of fields for SSHCertificate class&#34;&#34;&#34;

    DECODE_ORDER = []

    def __table__(self):
        return [getattr(self, item).__table__() for item in self.getattrs()]

    def __setattr__(self, name, value):
        field = getattr(self, name, None)

        if isinstance(value, _FIELD.CertificateField):
            self.replace_field(name, value)
            return

        if callable(field) and not isinstance(field, _FIELD.CertificateField):
            if field.__name__ == &#34;factory&#34;:
                super().__setattr__(name, field())
                self.__setattr__(name, value)
                return

        if isinstance(field, type) and getattr(value, &#34;__name__&#34;, &#34;&#34;) != &#34;factory&#34;:
            super().__setattr__(name, field(value))
            return

        if getattr(value, &#34;__name__&#34;, &#34;&#34;) != &#34;factory&#34;:
            field.value = value
            super().__setattr__(name, field)

    def replace_field(self, name: str, value: Union[_FIELD.CertificateField, type]):
        &#34;&#34;&#34;Completely replace field instead of just setting value (original __setattr__ behaviour)

        Args:
            name (str): The field to replace
            value (Union[_FIELD.CertificateField, type]): The CertificateField
            subclass or instance to replace with
        &#34;&#34;&#34;
        super(Fieldset, self).__setattr__(name, value)

    def get(self, name: str, default=None):
        &#34;&#34;&#34;Get field contents

        Args:
            name (str): Field name
            default (_type_, optional): The default value to return in case the
            field is not set. Defaults to None.

        Returns:
            mixed: The contents of the field
        &#34;&#34;&#34;
        field = getattr(self, name, default)
        if field:
            if isinstance(field, type):
                return field.DEFAULT
            return field.value
        return field

    def getattrs(self) -&gt; tuple:
        &#34;&#34;&#34;Get all class attributes

        Returns:
            tuple: All public class attributes
        &#34;&#34;&#34;
        # pylint: disable=consider-iterating-dictionary
        return tuple(att for att in self.__dict__.keys() if not att.startswith(&#34;_&#34;))

    def validate(self):
        &#34;&#34;&#34;Validate all fields to ensure the data is correct

        Returns:
            bool: True if valid, else exception
        &#34;&#34;&#34;
        ex = []
        for key in self.getattrs():
            if not getattr(self, key).validate():
                list(
                    ex.append(f&#34;{type(x)}: {str(x)}&#34;)
                    for x in getattr(self, key).exception
                    if isinstance(x, Exception)
                )

        return True if len(ex) == 0 else ex

    @classmethod
    def decode(cls, data: bytes) -&gt; Tuple[&#34;Fieldset&#34;, bytes]:
        &#34;&#34;&#34;Decode the certificate field data from a stream of bytes

        Returns:
            Tuple[Fieldset, bytes]: A tuple with the fieldset (Header, Fields or Footer)
            and the remaining bytes.
        &#34;&#34;&#34;
        cl_instance = cls()
        for item in cls.DECODE_ORDER:
            decoded, data = getattr(cl_instance, item).from_decode(data)
            setattr(cl_instance, item, decoded)

        return cl_instance, data</code></pre>
</details>
<h3>Subclasses</h3>
<ul class="hlist">
<li><a title="sshkey_tools.cert.CertificateFields" href="#sshkey_tools.cert.CertificateFields">CertificateFields</a></li>
<li><a title="sshkey_tools.cert.CertificateFooter" href="#sshkey_tools.cert.CertificateFooter">CertificateFooter</a></li>
<li><a title="sshkey_tools.cert.CertificateHeader" href="#sshkey_tools.cert.CertificateHeader">CertificateHeader</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="sshkey_tools.cert.Fieldset.DECODE_ORDER"><code class="name">var <span class="ident">DECODE_ORDER</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
</dl>
<h3>Static methods</h3>
<dl>
<dt id="sshkey_tools.cert.Fieldset.decode"><code class="name flex">
<span>def <span class="ident">decode</span></span>(<span>data: bytes) ‑> Tuple[<a title="sshkey_tools.cert.Fieldset" href="#sshkey_tools.cert.Fieldset">Fieldset</a>, bytes]</span>
</code></dt>
<dd>
<div class="desc"><p>Decode the certificate field data from a stream of bytes</p>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>Tuple[<a title="sshkey_tools.cert.Fieldset" href="#sshkey_tools.cert.Fieldset">Fieldset</a>, bytes]</code></dt>
<dd>A tuple with the fieldset (Header, Fields or Footer)</dd>
</dl>
<p>and the remaining bytes.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@classmethod
def decode(cls, data: bytes) -&gt; Tuple[&#34;Fieldset&#34;, bytes]:
    &#34;&#34;&#34;Decode the certificate field data from a stream of bytes

    Returns:
        Tuple[Fieldset, bytes]: A tuple with the fieldset (Header, Fields or Footer)
        and the remaining bytes.
    &#34;&#34;&#34;
    cl_instance = cls()
    for item in cls.DECODE_ORDER:
        decoded, data = getattr(cl_instance, item).from_decode(data)
        setattr(cl_instance, item, decoded)

    return cl_instance, data</code></pre>
</details>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="sshkey_tools.cert.Fieldset.get"><code class="name flex">
<span>def <span class="ident">get</span></span>(<span>self, name: str, default=None)</span>
</code></dt>
<dd>
<div class="desc"><p>Get field contents</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>name</code></strong> :&ensp;<code>str</code></dt>
<dd>Field name</dd>
<dt><strong><code>default</code></strong> :&ensp;<code>_type_</code>, optional</dt>
<dd>The default value to return in case the</dd>
</dl>
<p>field is not set. Defaults to None.</p>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>mixed</code></dt>
<dd>The contents of the field</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get(self, name: str, default=None):
    &#34;&#34;&#34;Get field contents

    Args:
        name (str): Field name
        default (_type_, optional): The default value to return in case the
        field is not set. Defaults to None.

    Returns:
        mixed: The contents of the field
    &#34;&#34;&#34;
    field = getattr(self, name, default)
    if field:
        if isinstance(field, type):
            return field.DEFAULT
        return field.value
    return field</code></pre>
</details>
</dd>
<dt id="sshkey_tools.cert.Fieldset.getattrs"><code class="name flex">
<span>def <span class="ident">getattrs</span></span>(<span>self) ‑> tuple</span>
</code></dt>
<dd>
<div class="desc"><p>Get all class attributes</p>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>tuple</code></dt>
<dd>All public class attributes</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def getattrs(self) -&gt; tuple:
    &#34;&#34;&#34;Get all class attributes

    Returns:
        tuple: All public class attributes
    &#34;&#34;&#34;
    # pylint: disable=consider-iterating-dictionary
    return tuple(att for att in self.__dict__.keys() if not att.startswith(&#34;_&#34;))</code></pre>
</details>
</dd>
<dt id="sshkey_tools.cert.Fieldset.replace_field"><code class="name flex">
<span>def <span class="ident">replace_field</span></span>(<span>self, name: str, value: Union[<a title="sshkey_tools.fields.CertificateField" href="fields.html#sshkey_tools.fields.CertificateField">CertificateField</a>, type])</span>
</code></dt>
<dd>
<div class="desc"><p>Completely replace field instead of just setting value (original <strong>setattr</strong> behaviour)</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>name</code></strong> :&ensp;<code>str</code></dt>
<dd>The field to replace</dd>
<dt><strong><code>value</code></strong> :&ensp;<code>Union[_FIELD.CertificateField, type]</code></dt>
<dd>The CertificateField</dd>
</dl>
<p>subclass or instance to replace with</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def replace_field(self, name: str, value: Union[_FIELD.CertificateField, type]):
    &#34;&#34;&#34;Completely replace field instead of just setting value (original __setattr__ behaviour)

    Args:
        name (str): The field to replace
        value (Union[_FIELD.CertificateField, type]): The CertificateField
        subclass or instance to replace with
    &#34;&#34;&#34;
    super(Fieldset, self).__setattr__(name, value)</code></pre>
</details>
</dd>
<dt id="sshkey_tools.cert.Fieldset.validate"><code class="name flex">
<span>def <span class="ident">validate</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"><p>Validate all fields to ensure the data is correct</p>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>bool</code></dt>
<dd>True if valid, else exception</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def validate(self):
    &#34;&#34;&#34;Validate all fields to ensure the data is correct

    Returns:
        bool: True if valid, else exception
    &#34;&#34;&#34;
    ex = []
    for key in self.getattrs():
        if not getattr(self, key).validate():
            list(
                ex.append(f&#34;{type(x)}: {str(x)}&#34;)
                for x in getattr(self, key).exception
                if isinstance(x, Exception)
            )

    return True if len(ex) == 0 else ex</code></pre>
</details>
</dd>
</dl>
</dd>
<dt id="sshkey_tools.cert.RsaCertificate"><code class="flex name class">
<span>class <span class="ident">RsaCertificate</span></span>
<span>(</span><span>subject_pubkey: <a title="sshkey_tools.keys.PublicKey" href="keys.html#sshkey_tools.keys.PublicKey">PublicKey</a> = None, ca_privkey: <a title="sshkey_tools.keys.PrivateKey" href="keys.html#sshkey_tools.keys.PrivateKey">PrivateKey</a> = None, fields: <a title="sshkey_tools.cert.CertificateFields" href="#sshkey_tools.cert.CertificateFields">CertificateFields</a> = sshkey_tools.cert.CertificateFields, header: <a title="sshkey_tools.cert.CertificateHeader" href="#sshkey_tools.cert.CertificateHeader">CertificateHeader</a> = sshkey_tools.cert.CertificateHeader, footer: <a title="sshkey_tools.cert.CertificateFooter" href="#sshkey_tools.cert.CertificateFooter">CertificateFooter</a> = sshkey_tools.cert.CertificateFooter)</span>
</code></dt>
<dd>
<div class="desc"><p>The RSA Certificate class</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class RsaCertificate(SSHCertificate):
    &#34;&#34;&#34;The RSA Certificate class&#34;&#34;&#34;

    DEFAULT_KEY_TYPE = &#34;rsa-sha2-512-cert-v01@openssh.com&#34;</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="sshkey_tools.cert.SSHCertificate" href="#sshkey_tools.cert.SSHCertificate">SSHCertificate</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="sshkey_tools.cert.RsaCertificate.DEFAULT_KEY_TYPE"><code class="name">var <span class="ident">DEFAULT_KEY_TYPE</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="sshkey_tools.cert.SSHCertificate" href="#sshkey_tools.cert.SSHCertificate">SSHCertificate</a></b></code>:
<ul class="hlist">
<li><code><a title="sshkey_tools.cert.SSHCertificate.can_sign" href="#sshkey_tools.cert.SSHCertificate.can_sign">can_sign</a></code></li>
<li><code><a title="sshkey_tools.cert.SSHCertificate.create" href="#sshkey_tools.cert.SSHCertificate.create">create</a></code></li>
<li><code><a title="sshkey_tools.cert.SSHCertificate.decode" href="#sshkey_tools.cert.SSHCertificate.decode">decode</a></code></li>
<li><code><a title="sshkey_tools.cert.SSHCertificate.from_bytes" href="#sshkey_tools.cert.SSHCertificate.from_bytes">from_bytes</a></code></li>
<li><code><a title="sshkey_tools.cert.SSHCertificate.from_file" href="#sshkey_tools.cert.SSHCertificate.from_file">from_file</a></code></li>
<li><code><a title="sshkey_tools.cert.SSHCertificate.from_string" href="#sshkey_tools.cert.SSHCertificate.from_string">from_string</a></code></li>
<li><code><a title="sshkey_tools.cert.SSHCertificate.get" href="#sshkey_tools.cert.SSHCertificate.get">get</a></code></li>
<li><code><a title="sshkey_tools.cert.SSHCertificate.get_signable" href="#sshkey_tools.cert.SSHCertificate.get_signable">get_signable</a></code></li>
<li><code><a title="sshkey_tools.cert.SSHCertificate.replace_ca" href="#sshkey_tools.cert.SSHCertificate.replace_ca">replace_ca</a></code></li>
<li><code><a title="sshkey_tools.cert.SSHCertificate.set" href="#sshkey_tools.cert.SSHCertificate.set">set</a></code></li>
<li><code><a title="sshkey_tools.cert.SSHCertificate.sign" href="#sshkey_tools.cert.SSHCertificate.sign">sign</a></code></li>
<li><code><a title="sshkey_tools.cert.SSHCertificate.to_file" href="#sshkey_tools.cert.SSHCertificate.to_file">to_file</a></code></li>
<li><code><a title="sshkey_tools.cert.SSHCertificate.to_string" href="#sshkey_tools.cert.SSHCertificate.to_string">to_string</a></code></li>
<li><code><a title="sshkey_tools.cert.SSHCertificate.verify" href="#sshkey_tools.cert.SSHCertificate.verify">verify</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="sshkey_tools.cert.SSHCertificate"><code class="flex name class">
<span>class <span class="ident">SSHCertificate</span></span>
<span>(</span><span>subject_pubkey: <a title="sshkey_tools.keys.PublicKey" href="keys.html#sshkey_tools.keys.PublicKey">PublicKey</a> = None, ca_privkey: <a title="sshkey_tools.keys.PrivateKey" href="keys.html#sshkey_tools.keys.PrivateKey">PrivateKey</a> = None, fields: <a title="sshkey_tools.cert.CertificateFields" href="#sshkey_tools.cert.CertificateFields">CertificateFields</a> = sshkey_tools.cert.CertificateFields, header: <a title="sshkey_tools.cert.CertificateHeader" href="#sshkey_tools.cert.CertificateHeader">CertificateHeader</a> = sshkey_tools.cert.CertificateHeader, footer: <a title="sshkey_tools.cert.CertificateFooter" href="#sshkey_tools.cert.CertificateFooter">CertificateFooter</a> = sshkey_tools.cert.CertificateFooter)</span>
</code></dt>
<dd>
<div class="desc"><p>General class for SSH Certificates, used for loading and parsing.
To create new certificates, use the respective keytype classes
or the from_public_key classmethod</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class SSHCertificate:
    &#34;&#34;&#34;
    General class for SSH Certificates, used for loading and parsing.
    To create new certificates, use the respective keytype classes
    or the from_public_key classmethod
    &#34;&#34;&#34;

    DEFAULT_KEY_TYPE = &#34;none@openssh.com&#34;

    # pylint: disable=too-many-arguments
    def __init__(
        self,
        subject_pubkey: PublicKey = None,
        ca_privkey: PrivateKey = None,
        fields: CertificateFields = CertificateFields,
        header: CertificateHeader = CertificateHeader,
        footer: CertificateFooter = CertificateFooter,
    ):
        if self.__class__.__name__ == &#34;SSHCertificate&#34;:
            raise _EX.InvalidClassCallException(
                &#34;You cannot instantiate SSHCertificate directly. Use \n&#34;
                + &#34;one of the child classes, or call via decode, create \n&#34;
                + &#34;or one of the from_-classmethods&#34;
            )

        self.fields = fields() if isinstance(fields, type) else fields
        self.header = header() if isinstance(header, type) else header
        self.footer = footer() if isinstance(footer, type) else footer

        if isinstance(header, type) and subject_pubkey is not None:
            self.header.pubkey_type = self.DEFAULT_KEY_TYPE
            self.header.replace_field(
                &#34;public_key&#34;, _FIELD.PublicKeyField.from_object(subject_pubkey)
            )

        if isinstance(footer, type) and ca_privkey is not None:
            self.footer.ca_pubkey = ca_privkey.public_key
            self.footer.replace_field(
                &#34;signature&#34;, _FIELD.SignatureField.from_object(ca_privkey)
            )

        self.__post_init__()

    def __post_init__(self):
        &#34;&#34;&#34;Extensible function for post-initialization for child classes&#34;&#34;&#34;

    def __bytes__(self):
        if not self.footer.signature.is_signed:
            raise _EX.InvalidCertificateFormatException(
                &#34;Failed exporting certificate: Certificate is not signed&#34;
            )

        return concat_to_bytestring(
            bytes(self.header),
            bytes(self.fields),
            bytes(self.footer),
            bytes(self.footer.signature),
        )

    def __str__(self) -&gt; str:
        table = PrettyTable([&#34;Field&#34;, &#34;Value&#34;])

        for item in (self.header, self.fields, self.footer):
            for row in item.__table__():
                table.add_row(row)

        return str(table)

    @classmethod
    def create(
        cls,
        subject_pubkey: PublicKey = None,
        ca_privkey: PrivateKey = None,
        fields: CertificateFields = CertificateFields,
        header: CertificateHeader = CertificateHeader,
        footer: CertificateFooter = CertificateFooter,
    ) -&gt; &#34;SSHCertificate&#34;:
        &#34;&#34;&#34;
        Creates a new certificate from the given parameters.

        Args:
            subject_pubkey (PublicKey, optional): The subject public key. Defaults to None.
            ca_privkey (PrivateKey, optional): The CA private key. Defaults to None.
            fields (CertificateFields, optional): The CertificateFields object containing the
                body fields. Defaults to blank CertificateFields.
            header (CertificateHeader, optional): The certificate header.
                Defaults to new CertificateHeader.
            footer (CertificateFooter, optional): The certificate footer.
                Defaults to new CertificateFooter.

        Returns:
            SSHCertificate: A SSHCertificate subclass depending on the type of subject_pubkey
        &#34;&#34;&#34;
        cert_class = subject_pubkey.__class__.__name__.replace(
            &#34;PublicKey&#34;, &#34;Certificate&#34;
        )
        return globals()[cert_class](
            subject_pubkey=subject_pubkey,
            ca_privkey=ca_privkey,
            fields=fields,
            header=header,
            footer=footer,
        )

    @classmethod
    def decode(cls, data: bytes) -&gt; &#34;SSHCertificate&#34;:
        &#34;&#34;&#34;
        Decode an existing certificate and import it into a new object

        Args:
            data (bytes): The certificate bytes, base64 decoded middle part of the certificate

        Returns:
            SSHCertificate: SSHCertificate child class
        &#34;&#34;&#34;
        cert_header, data = CertificateHeader.decode(data)
        cert_fields, data = CertificateFields.decode(data)
        cert_footer, data = CertificateFooter.decode(data)

        return cls(header=cert_header, fields=cert_fields, footer=cert_footer)

    @classmethod
    def from_bytes(cls, cert_bytes: bytes):
        &#34;&#34;&#34;
        Loads an existing certificate from the byte value.

        Args:
            cert_bytes (bytes): Certificate bytes, base64 decoded middle part of the certificate

        Returns:
            SSHCertificate: SSHCertificate child class
        &#34;&#34;&#34;
        cert_type, _ = _FIELD.StringField.decode(cert_bytes)
        target_class = CERT_TYPES[cert_type]
        return globals()[target_class[0]].decode(cert_bytes)

    @classmethod
    def from_string(cls, cert_str: Union[str, bytes], encoding: str = &#34;utf-8&#34;):
        &#34;&#34;&#34;
        Loads an existing certificate from a string in the format
        [certificate-type] [base64-encoded-certificate] [optional-comment]

        Args:
            cert_str (str): The string containing the certificate
            encoding (str, optional): The encoding of the string. Defaults to &#39;utf-8&#39;.

        Returns:
            SSHCertificate: SSHCertificate child class
        &#34;&#34;&#34;
        cert_str = ensure_bytestring(cert_str, encoding)

        certificate = b64decode(cert_str.split(b&#34; &#34;)[1])
        return cls.from_bytes(cert_bytes=certificate)

    @classmethod
    def from_file(cls, path: str, encoding: str = &#34;utf-8&#34;):
        &#34;&#34;&#34;
        Loads an existing certificate from a file

        Args:
            path (str): The path to the certificate file
            encoding (str, optional): Encoding of the file. Defaults to &#39;utf-8&#39;.

        Returns:
            SSHCertificate: SSHCertificate child class
        &#34;&#34;&#34;
        with open(path, &#34;r&#34;, encoding=encoding) as file:
            return cls.from_string(file.read())

    def get(self, field: str):
        &#34;&#34;&#34;
        Fetch a field from any of the sections of the certificate.

        Args:
            field (str): The field name to fetch

        Raises:
            _EX.InvalidCertificateFieldException: Invalid field name provided

        Returns:
            mixed: The certificate field contents
        &#34;&#34;&#34;
        if field in (
            self.header.getattrs() + self.fields.getattrs() + self.footer.getattrs()
        ):
            return (
                self.fields.get(field, False)
                or self.header.get(field, False)
                or self.footer.get(field, False)
            )

        raise _EX.InvalidCertificateFieldException(f&#34;Unknown field {field}&#34;)

    def set(self, field: str, value) -&gt; None:
        &#34;&#34;&#34;
        Set a field in any of the sections of the certificate.

        Args:
            field (str): The field name to set
            value (mixed): The value to set the field to

        Raises:
            _EX.InvalidCertificateFieldException: Invalid field name provided

        Returns:
            mixed: The certificate field contents
        &#34;&#34;&#34;
        if self.fields.get(field, False):
            setattr(self.fields, field, value)
            return

        if self.header.get(field, False):
            setattr(self.header, field, value)
            return

        if self.footer.get(field, False):
            setattr(self.footer, field, value)
            return

        raise _EX.InvalidCertificateFieldException(f&#34;Unknown field {field}&#34;)

    def replace_ca(self, ca_privkey: PrivateKey):
        &#34;&#34;&#34;
        Replace the certificate authority private key with a new one.

        Args:
            ca_privkey (PrivateKey): The new CA private key
        &#34;&#34;&#34;
        self.footer.ca_pubkey = ca_privkey.public_key
        self.footer.replace_field(
            &#34;signature&#34;, _FIELD.SignatureField.from_object(ca_privkey)
        )

    def can_sign(self) -&gt; bool:
        &#34;&#34;&#34;
        Check if the certificate can be signed in its current state.

        Raises:
            _EX.SignatureNotPossibleException: Exception if the certificate cannot be signed

        Returns:
            bool: True if the certificate can be signed
        &#34;&#34;&#34;
        valid_header = self.header.validate()
        valid_fields = self.fields.validate()
        check_keys = (
            True
            if isinstance(self.get(&#34;ca_pubkey&#34;), PublicKey)
            and isinstance(self.footer.signature.private_key, PrivateKey)
            else [
                _EX.SignatureNotPossibleException(&#34;No CA Public/Private key is loaded&#34;)
            ]
        )

        if (valid_header, valid_fields, check_keys) != (True, True, True):
            exceptions = []
            exceptions += valid_header if not isinstance(valid_header, bool) else []
            exceptions += valid_fields if not isinstance(valid_fields, bool) else []
            exceptions += check_keys if not isinstance(check_keys, bool) else []
            raise _EX.SignatureNotPossibleException(
                &#34;\n&#34;.join([str(e) for e in exceptions])
            )

        return True

    def get_signable(self) -&gt; bytes:
        &#34;&#34;&#34;
        Retrieves the signable data for the certificate in byte form
        &#34;&#34;&#34;
        return concat_to_bytestring(
            bytes(self.header), bytes(self.fields), bytes(self.footer)
        )

    def sign(self) -&gt; bool:
        &#34;&#34;&#34;Sign the certificate

        Raises:
            _EX.NotSignedException: The certificate could not be signed

        Returns:
            bool: Whether successful
        &#34;&#34;&#34;
        if self.can_sign():
            self.footer.signature.sign(data=self.get_signable())

            return True
        raise _EX.NotSignedException(&#34;There was an error while signing the certificate&#34;)

    def verify(
        self, public_key: PublicKey = None, raise_on_error: bool = False
    ) -&gt; bool:
        &#34;&#34;&#34;Verify the signature on the certificate to make sure the data is not corrupted,
           and that the signature comes from the given public key or the key included in the
           certificate (insecure, useful for testing only)

        Args:
            public_key (PublicKey, optional): The public key to use for verification
            raise_on_error (bool, default False): Raise an exception if the certificate is invalid

        Raises:
            _EX.InvalidSignatureException: The signature is invalid
        &#34;&#34;&#34;
        if not public_key:
            public_key = self.get(&#34;ca_pubkey&#34;)

        try:
            public_key.verify(self.get_signable(), self.footer.get(&#34;signature&#34;))
        except _EX.InvalidSignatureException as exception:
            if raise_on_error:
                raise exception
            return False

        return True

    def to_string(self, comment: str = &#34;&#34;, encoding: str = &#34;utf-8&#34;):
        &#34;&#34;&#34;Export the certificate to a string

        Args:
            comment (str, optional): Comment to append to the certificate. Defaults to &#34;&#34;.
            encoding (str, optional): Which encoding to use for the string. Defaults to &#34;utf-8&#34;.

        Returns:
            str: The certificate data, base64-encoded and in string format
        &#34;&#34;&#34;
        return concat_to_string(
            self.header.get(&#34;pubkey_type&#34;),
            &#34; &#34;,
            b64encode(bytes(self)),
            &#34; &#34;,
            comment if comment else &#34;&#34;,
            encoding=encoding,
        )

    def to_file(self, filename: str, encoding: str = &#34;utf-8&#34;):
        &#34;&#34;&#34;Export certificate to file

        Args:
            filename (str): The filename to write to
            encoding (str, optional): The encoding to use for the file/string. Defaults to &#34;utf-8&#34;.
        &#34;&#34;&#34;
        with open(filename, &#34;w&#34;, encoding=encoding) as file:
            file.write(self.to_string())</code></pre>
</details>
<h3>Subclasses</h3>
<ul class="hlist">
<li><a title="sshkey_tools.cert.DsaCertificate" href="#sshkey_tools.cert.DsaCertificate">DsaCertificate</a></li>
<li><a title="sshkey_tools.cert.EcdsaCertificate" href="#sshkey_tools.cert.EcdsaCertificate">EcdsaCertificate</a></li>
<li><a title="sshkey_tools.cert.Ed25519Certificate" href="#sshkey_tools.cert.Ed25519Certificate">Ed25519Certificate</a></li>
<li><a title="sshkey_tools.cert.RsaCertificate" href="#sshkey_tools.cert.RsaCertificate">RsaCertificate</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="sshkey_tools.cert.SSHCertificate.DEFAULT_KEY_TYPE"><code class="name">var <span class="ident">DEFAULT_KEY_TYPE</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
</dl>
<h3>Static methods</h3>
<dl>
<dt id="sshkey_tools.cert.SSHCertificate.create"><code class="name flex">
<span>def <span class="ident">create</span></span>(<span>subject_pubkey: <a title="sshkey_tools.keys.PublicKey" href="keys.html#sshkey_tools.keys.PublicKey">PublicKey</a> = None, ca_privkey: <a title="sshkey_tools.keys.PrivateKey" href="keys.html#sshkey_tools.keys.PrivateKey">PrivateKey</a> = None, fields: <a title="sshkey_tools.cert.CertificateFields" href="#sshkey_tools.cert.CertificateFields">CertificateFields</a> = sshkey_tools.cert.CertificateFields, header: <a title="sshkey_tools.cert.CertificateHeader" href="#sshkey_tools.cert.CertificateHeader">CertificateHeader</a> = sshkey_tools.cert.CertificateHeader, footer: <a title="sshkey_tools.cert.CertificateFooter" href="#sshkey_tools.cert.CertificateFooter">CertificateFooter</a> = sshkey_tools.cert.CertificateFooter) ‑> <a title="sshkey_tools.cert.SSHCertificate" href="#sshkey_tools.cert.SSHCertificate">SSHCertificate</a></span>
</code></dt>
<dd>
<div class="desc"><p>Creates a new certificate from the given parameters.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>subject_pubkey</code></strong> :&ensp;<code>PublicKey</code>, optional</dt>
<dd>The subject public key. Defaults to None.</dd>
<dt><strong><code>ca_privkey</code></strong> :&ensp;<code>PrivateKey</code>, optional</dt>
<dd>The CA private key. Defaults to None.</dd>
<dt><strong><code>fields</code></strong> :&ensp;<code><a title="sshkey_tools.cert.CertificateFields" href="#sshkey_tools.cert.CertificateFields">CertificateFields</a></code>, optional</dt>
<dd>The CertificateFields object containing the
body fields. Defaults to blank CertificateFields.</dd>
<dt><strong><code>header</code></strong> :&ensp;<code><a title="sshkey_tools.cert.CertificateHeader" href="#sshkey_tools.cert.CertificateHeader">CertificateHeader</a></code>, optional</dt>
<dd>The certificate header.
Defaults to new CertificateHeader.</dd>
<dt><strong><code>footer</code></strong> :&ensp;<code><a title="sshkey_tools.cert.CertificateFooter" href="#sshkey_tools.cert.CertificateFooter">CertificateFooter</a></code>, optional</dt>
<dd>The certificate footer.
Defaults to new CertificateFooter.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code><a title="sshkey_tools.cert.SSHCertificate" href="#sshkey_tools.cert.SSHCertificate">SSHCertificate</a></code></dt>
<dd>A SSHCertificate subclass depending on the type of subject_pubkey</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@classmethod
def create(
    cls,
    subject_pubkey: PublicKey = None,
    ca_privkey: PrivateKey = None,
    fields: CertificateFields = CertificateFields,
    header: CertificateHeader = CertificateHeader,
    footer: CertificateFooter = CertificateFooter,
) -&gt; &#34;SSHCertificate&#34;:
    &#34;&#34;&#34;
    Creates a new certificate from the given parameters.

    Args:
        subject_pubkey (PublicKey, optional): The subject public key. Defaults to None.
        ca_privkey (PrivateKey, optional): The CA private key. Defaults to None.
        fields (CertificateFields, optional): The CertificateFields object containing the
            body fields. Defaults to blank CertificateFields.
        header (CertificateHeader, optional): The certificate header.
            Defaults to new CertificateHeader.
        footer (CertificateFooter, optional): The certificate footer.
            Defaults to new CertificateFooter.

    Returns:
        SSHCertificate: A SSHCertificate subclass depending on the type of subject_pubkey
    &#34;&#34;&#34;
    cert_class = subject_pubkey.__class__.__name__.replace(
        &#34;PublicKey&#34;, &#34;Certificate&#34;
    )
    return globals()[cert_class](
        subject_pubkey=subject_pubkey,
        ca_privkey=ca_privkey,
        fields=fields,
        header=header,
        footer=footer,
    )</code></pre>
</details>
</dd>
<dt id="sshkey_tools.cert.SSHCertificate.decode"><code class="name flex">
<span>def <span class="ident">decode</span></span>(<span>data: bytes) ‑> <a title="sshkey_tools.cert.SSHCertificate" href="#sshkey_tools.cert.SSHCertificate">SSHCertificate</a></span>
</code></dt>
<dd>
<div class="desc"><p>Decode an existing certificate and import it into a new object</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>data</code></strong> :&ensp;<code>bytes</code></dt>
<dd>The certificate bytes, base64 decoded middle part of the certificate</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code><a title="sshkey_tools.cert.SSHCertificate" href="#sshkey_tools.cert.SSHCertificate">SSHCertificate</a></code></dt>
<dd>SSHCertificate child class</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@classmethod
def decode(cls, data: bytes) -&gt; &#34;SSHCertificate&#34;:
    &#34;&#34;&#34;
    Decode an existing certificate and import it into a new object

    Args:
        data (bytes): The certificate bytes, base64 decoded middle part of the certificate

    Returns:
        SSHCertificate: SSHCertificate child class
    &#34;&#34;&#34;
    cert_header, data = CertificateHeader.decode(data)
    cert_fields, data = CertificateFields.decode(data)
    cert_footer, data = CertificateFooter.decode(data)

    return cls(header=cert_header, fields=cert_fields, footer=cert_footer)</code></pre>
</details>
</dd>
<dt id="sshkey_tools.cert.SSHCertificate.from_bytes"><code class="name flex">
<span>def <span class="ident">from_bytes</span></span>(<span>cert_bytes: bytes)</span>
</code></dt>
<dd>
<div class="desc"><p>Loads an existing certificate from the byte value.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>cert_bytes</code></strong> :&ensp;<code>bytes</code></dt>
<dd>Certificate bytes, base64 decoded middle part of the certificate</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code><a title="sshkey_tools.cert.SSHCertificate" href="#sshkey_tools.cert.SSHCertificate">SSHCertificate</a></code></dt>
<dd>SSHCertificate child class</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@classmethod
def from_bytes(cls, cert_bytes: bytes):
    &#34;&#34;&#34;
    Loads an existing certificate from the byte value.

    Args:
        cert_bytes (bytes): Certificate bytes, base64 decoded middle part of the certificate

    Returns:
        SSHCertificate: SSHCertificate child class
    &#34;&#34;&#34;
    cert_type, _ = _FIELD.StringField.decode(cert_bytes)
    target_class = CERT_TYPES[cert_type]
    return globals()[target_class[0]].decode(cert_bytes)</code></pre>
</details>
</dd>
<dt id="sshkey_tools.cert.SSHCertificate.from_file"><code class="name flex">
<span>def <span class="ident">from_file</span></span>(<span>path: str, encoding: str = 'utf-8')</span>
</code></dt>
<dd>
<div class="desc"><p>Loads an existing certificate from a file</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>path</code></strong> :&ensp;<code>str</code></dt>
<dd>The path to the certificate file</dd>
<dt><strong><code>encoding</code></strong> :&ensp;<code>str</code>, optional</dt>
<dd>Encoding of the file. Defaults to 'utf-8'.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code><a title="sshkey_tools.cert.SSHCertificate" href="#sshkey_tools.cert.SSHCertificate">SSHCertificate</a></code></dt>
<dd>SSHCertificate child class</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@classmethod
def from_file(cls, path: str, encoding: str = &#34;utf-8&#34;):
    &#34;&#34;&#34;
    Loads an existing certificate from a file

    Args:
        path (str): The path to the certificate file
        encoding (str, optional): Encoding of the file. Defaults to &#39;utf-8&#39;.

    Returns:
        SSHCertificate: SSHCertificate child class
    &#34;&#34;&#34;
    with open(path, &#34;r&#34;, encoding=encoding) as file:
        return cls.from_string(file.read())</code></pre>
</details>
</dd>
<dt id="sshkey_tools.cert.SSHCertificate.from_string"><code class="name flex">
<span>def <span class="ident">from_string</span></span>(<span>cert_str: Union[str, bytes], encoding: str = 'utf-8')</span>
</code></dt>
<dd>
<div class="desc"><p>Loads an existing certificate from a string in the format
[certificate-type] [base64-encoded-certificate] [optional-comment]</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>cert_str</code></strong> :&ensp;<code>str</code></dt>
<dd>The string containing the certificate</dd>
<dt><strong><code>encoding</code></strong> :&ensp;<code>str</code>, optional</dt>
<dd>The encoding of the string. Defaults to 'utf-8'.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code><a title="sshkey_tools.cert.SSHCertificate" href="#sshkey_tools.cert.SSHCertificate">SSHCertificate</a></code></dt>
<dd>SSHCertificate child class</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@classmethod
def from_string(cls, cert_str: Union[str, bytes], encoding: str = &#34;utf-8&#34;):
    &#34;&#34;&#34;
    Loads an existing certificate from a string in the format
    [certificate-type] [base64-encoded-certificate] [optional-comment]

    Args:
        cert_str (str): The string containing the certificate
        encoding (str, optional): The encoding of the string. Defaults to &#39;utf-8&#39;.

    Returns:
        SSHCertificate: SSHCertificate child class
    &#34;&#34;&#34;
    cert_str = ensure_bytestring(cert_str, encoding)

    certificate = b64decode(cert_str.split(b&#34; &#34;)[1])
    return cls.from_bytes(cert_bytes=certificate)</code></pre>
</details>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="sshkey_tools.cert.SSHCertificate.can_sign"><code class="name flex">
<span>def <span class="ident">can_sign</span></span>(<span>self) ‑> bool</span>
</code></dt>
<dd>
<div class="desc"><p>Check if the certificate can be signed in its current state.</p>
<h2 id="raises">Raises</h2>
<dl>
<dt><code>_EX.SignatureNotPossibleException</code></dt>
<dd>Exception if the certificate cannot be signed</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>bool</code></dt>
<dd>True if the certificate can be signed</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def can_sign(self) -&gt; bool:
    &#34;&#34;&#34;
    Check if the certificate can be signed in its current state.

    Raises:
        _EX.SignatureNotPossibleException: Exception if the certificate cannot be signed

    Returns:
        bool: True if the certificate can be signed
    &#34;&#34;&#34;
    valid_header = self.header.validate()
    valid_fields = self.fields.validate()
    check_keys = (
        True
        if isinstance(self.get(&#34;ca_pubkey&#34;), PublicKey)
        and isinstance(self.footer.signature.private_key, PrivateKey)
        else [
            _EX.SignatureNotPossibleException(&#34;No CA Public/Private key is loaded&#34;)
        ]
    )

    if (valid_header, valid_fields, check_keys) != (True, True, True):
        exceptions = []
        exceptions += valid_header if not isinstance(valid_header, bool) else []
        exceptions += valid_fields if not isinstance(valid_fields, bool) else []
        exceptions += check_keys if not isinstance(check_keys, bool) else []
        raise _EX.SignatureNotPossibleException(
            &#34;\n&#34;.join([str(e) for e in exceptions])
        )

    return True</code></pre>
</details>
</dd>
<dt id="sshkey_tools.cert.SSHCertificate.get"><code class="name flex">
<span>def <span class="ident">get</span></span>(<span>self, field: str)</span>
</code></dt>
<dd>
<div class="desc"><p>Fetch a field from any of the sections of the certificate.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>field</code></strong> :&ensp;<code>str</code></dt>
<dd>The field name to fetch</dd>
</dl>
<h2 id="raises">Raises</h2>
<dl>
<dt><code>_EX.InvalidCertificateFieldException</code></dt>
<dd>Invalid field name provided</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>mixed</code></dt>
<dd>The certificate field contents</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get(self, field: str):
    &#34;&#34;&#34;
    Fetch a field from any of the sections of the certificate.

    Args:
        field (str): The field name to fetch

    Raises:
        _EX.InvalidCertificateFieldException: Invalid field name provided

    Returns:
        mixed: The certificate field contents
    &#34;&#34;&#34;
    if field in (
        self.header.getattrs() + self.fields.getattrs() + self.footer.getattrs()
    ):
        return (
            self.fields.get(field, False)
            or self.header.get(field, False)
            or self.footer.get(field, False)
        )

    raise _EX.InvalidCertificateFieldException(f&#34;Unknown field {field}&#34;)</code></pre>
</details>
</dd>
<dt id="sshkey_tools.cert.SSHCertificate.get_signable"><code class="name flex">
<span>def <span class="ident">get_signable</span></span>(<span>self) ‑> bytes</span>
</code></dt>
<dd>
<div class="desc"><p>Retrieves the signable data for the certificate in byte form</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_signable(self) -&gt; bytes:
    &#34;&#34;&#34;
    Retrieves the signable data for the certificate in byte form
    &#34;&#34;&#34;
    return concat_to_bytestring(
        bytes(self.header), bytes(self.fields), bytes(self.footer)
    )</code></pre>
</details>
</dd>
<dt id="sshkey_tools.cert.SSHCertificate.replace_ca"><code class="name flex">
<span>def <span class="ident">replace_ca</span></span>(<span>self, ca_privkey: <a title="sshkey_tools.keys.PrivateKey" href="keys.html#sshkey_tools.keys.PrivateKey">PrivateKey</a>)</span>
</code></dt>
<dd>
<div class="desc"><p>Replace the certificate authority private key with a new one.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>ca_privkey</code></strong> :&ensp;<code>PrivateKey</code></dt>
<dd>The new CA private key</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def replace_ca(self, ca_privkey: PrivateKey):
    &#34;&#34;&#34;
    Replace the certificate authority private key with a new one.

    Args:
        ca_privkey (PrivateKey): The new CA private key
    &#34;&#34;&#34;
    self.footer.ca_pubkey = ca_privkey.public_key
    self.footer.replace_field(
        &#34;signature&#34;, _FIELD.SignatureField.from_object(ca_privkey)
    )</code></pre>
</details>
</dd>
<dt id="sshkey_tools.cert.SSHCertificate.set"><code class="name flex">
<span>def <span class="ident">set</span></span>(<span>self, field: str, value) ‑> None</span>
</code></dt>
<dd>
<div class="desc"><p>Set a field in any of the sections of the certificate.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>field</code></strong> :&ensp;<code>str</code></dt>
<dd>The field name to set</dd>
<dt><strong><code>value</code></strong> :&ensp;<code>mixed</code></dt>
<dd>The value to set the field to</dd>
</dl>
<h2 id="raises">Raises</h2>
<dl>
<dt><code>_EX.InvalidCertificateFieldException</code></dt>
<dd>Invalid field name provided</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>mixed</code></dt>
<dd>The certificate field contents</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def set(self, field: str, value) -&gt; None:
    &#34;&#34;&#34;
    Set a field in any of the sections of the certificate.

    Args:
        field (str): The field name to set
        value (mixed): The value to set the field to

    Raises:
        _EX.InvalidCertificateFieldException: Invalid field name provided

    Returns:
        mixed: The certificate field contents
    &#34;&#34;&#34;
    if self.fields.get(field, False):
        setattr(self.fields, field, value)
        return

    if self.header.get(field, False):
        setattr(self.header, field, value)
        return

    if self.footer.get(field, False):
        setattr(self.footer, field, value)
        return

    raise _EX.InvalidCertificateFieldException(f&#34;Unknown field {field}&#34;)</code></pre>
</details>
</dd>
<dt id="sshkey_tools.cert.SSHCertificate.sign"><code class="name flex">
<span>def <span class="ident">sign</span></span>(<span>self) ‑> bool</span>
</code></dt>
<dd>
<div class="desc"><p>Sign the certificate</p>
<h2 id="raises">Raises</h2>
<dl>
<dt><code>_EX.NotSignedException</code></dt>
<dd>The certificate could not be signed</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>bool</code></dt>
<dd>Whether successful</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def sign(self) -&gt; bool:
    &#34;&#34;&#34;Sign the certificate

    Raises:
        _EX.NotSignedException: The certificate could not be signed

    Returns:
        bool: Whether successful
    &#34;&#34;&#34;
    if self.can_sign():
        self.footer.signature.sign(data=self.get_signable())

        return True
    raise _EX.NotSignedException(&#34;There was an error while signing the certificate&#34;)</code></pre>
</details>
</dd>
<dt id="sshkey_tools.cert.SSHCertificate.to_file"><code class="name flex">
<span>def <span class="ident">to_file</span></span>(<span>self, filename: str, encoding: str = 'utf-8')</span>
</code></dt>
<dd>
<div class="desc"><p>Export certificate to file</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>filename</code></strong> :&ensp;<code>str</code></dt>
<dd>The filename to write to</dd>
<dt><strong><code>encoding</code></strong> :&ensp;<code>str</code>, optional</dt>
<dd>The encoding to use for the file/string. Defaults to "utf-8".</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def to_file(self, filename: str, encoding: str = &#34;utf-8&#34;):
    &#34;&#34;&#34;Export certificate to file

    Args:
        filename (str): The filename to write to
        encoding (str, optional): The encoding to use for the file/string. Defaults to &#34;utf-8&#34;.
    &#34;&#34;&#34;
    with open(filename, &#34;w&#34;, encoding=encoding) as file:
        file.write(self.to_string())</code></pre>
</details>
</dd>
<dt id="sshkey_tools.cert.SSHCertificate.to_string"><code class="name flex">
<span>def <span class="ident">to_string</span></span>(<span>self, comment: str = '', encoding: str = 'utf-8')</span>
</code></dt>
<dd>
<div class="desc"><p>Export the certificate to a string</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>comment</code></strong> :&ensp;<code>str</code>, optional</dt>
<dd>Comment to append to the certificate. Defaults to "".</dd>
<dt><strong><code>encoding</code></strong> :&ensp;<code>str</code>, optional</dt>
<dd>Which encoding to use for the string. Defaults to "utf-8".</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>str</code></dt>
<dd>The certificate data, base64-encoded and in string format</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def to_string(self, comment: str = &#34;&#34;, encoding: str = &#34;utf-8&#34;):
    &#34;&#34;&#34;Export the certificate to a string

    Args:
        comment (str, optional): Comment to append to the certificate. Defaults to &#34;&#34;.
        encoding (str, optional): Which encoding to use for the string. Defaults to &#34;utf-8&#34;.

    Returns:
        str: The certificate data, base64-encoded and in string format
    &#34;&#34;&#34;
    return concat_to_string(
        self.header.get(&#34;pubkey_type&#34;),
        &#34; &#34;,
        b64encode(bytes(self)),
        &#34; &#34;,
        comment if comment else &#34;&#34;,
        encoding=encoding,
    )</code></pre>
</details>
</dd>
<dt id="sshkey_tools.cert.SSHCertificate.verify"><code class="name flex">
<span>def <span class="ident">verify</span></span>(<span>self, public_key: <a title="sshkey_tools.keys.PublicKey" href="keys.html#sshkey_tools.keys.PublicKey">PublicKey</a> = None, raise_on_error: bool = False) ‑> bool</span>
</code></dt>
<dd>
<div class="desc"><p>Verify the signature on the certificate to make sure the data is not corrupted,
and that the signature comes from the given public key or the key included in the
certificate (insecure, useful for testing only)</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>public_key</code></strong> :&ensp;<code>PublicKey</code>, optional</dt>
<dd>The public key to use for verification</dd>
<dt><strong><code>raise_on_error</code></strong> :&ensp;<code>bool</code>, default <code>False</code></dt>
<dd>Raise an exception if the certificate is invalid</dd>
</dl>
<h2 id="raises">Raises</h2>
<dl>
<dt><code>_EX.InvalidSignatureException</code></dt>
<dd>The signature is invalid</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def verify(
    self, public_key: PublicKey = None, raise_on_error: bool = False
) -&gt; bool:
    &#34;&#34;&#34;Verify the signature on the certificate to make sure the data is not corrupted,
       and that the signature comes from the given public key or the key included in the
       certificate (insecure, useful for testing only)

    Args:
        public_key (PublicKey, optional): The public key to use for verification
        raise_on_error (bool, default False): Raise an exception if the certificate is invalid

    Raises:
        _EX.InvalidSignatureException: The signature is invalid
    &#34;&#34;&#34;
    if not public_key:
        public_key = self.get(&#34;ca_pubkey&#34;)

    try:
        public_key.verify(self.get_signable(), self.footer.get(&#34;signature&#34;))
    except _EX.InvalidSignatureException as exception:
        if raise_on_error:
            raise exception
        return False

    return True</code></pre>
</details>
</dd>
</dl>
</dd>
</dl>
</section>
</article>
<nav id="sidebar">
<h1>Index</h1>
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="sshkey_tools" href="index.html">sshkey_tools</a></code></li>
</ul>
</li>
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="sshkey_tools.cert.CertificateFields" href="#sshkey_tools.cert.CertificateFields">CertificateFields</a></code></h4>
<ul class="two-column">
<li><code><a title="sshkey_tools.cert.CertificateFields.DECODE_ORDER" href="#sshkey_tools.cert.CertificateFields.DECODE_ORDER">DECODE_ORDER</a></code></li>
<li><code><a title="sshkey_tools.cert.CertificateFields.cert_type" href="#sshkey_tools.cert.CertificateFields.cert_type">cert_type</a></code></li>
<li><code><a title="sshkey_tools.cert.CertificateFields.critical_options" href="#sshkey_tools.cert.CertificateFields.critical_options">critical_options</a></code></li>
<li><code><a title="sshkey_tools.cert.CertificateFields.extensions" href="#sshkey_tools.cert.CertificateFields.extensions">extensions</a></code></li>
<li><code><a title="sshkey_tools.cert.CertificateFields.key_id" href="#sshkey_tools.cert.CertificateFields.key_id">key_id</a></code></li>
<li><code><a title="sshkey_tools.cert.CertificateFields.principals" href="#sshkey_tools.cert.CertificateFields.principals">principals</a></code></li>
<li><code><a title="sshkey_tools.cert.CertificateFields.serial" href="#sshkey_tools.cert.CertificateFields.serial">serial</a></code></li>
<li><code><a title="sshkey_tools.cert.CertificateFields.valid_after" href="#sshkey_tools.cert.CertificateFields.valid_after">valid_after</a></code></li>
<li><code><a title="sshkey_tools.cert.CertificateFields.valid_before" href="#sshkey_tools.cert.CertificateFields.valid_before">valid_before</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="sshkey_tools.cert.CertificateFooter" href="#sshkey_tools.cert.CertificateFooter">CertificateFooter</a></code></h4>
<ul class="">
<li><code><a title="sshkey_tools.cert.CertificateFooter.DECODE_ORDER" href="#sshkey_tools.cert.CertificateFooter.DECODE_ORDER">DECODE_ORDER</a></code></li>
<li><code><a title="sshkey_tools.cert.CertificateFooter.ca_pubkey" href="#sshkey_tools.cert.CertificateFooter.ca_pubkey">ca_pubkey</a></code></li>
<li><code><a title="sshkey_tools.cert.CertificateFooter.reserved" href="#sshkey_tools.cert.CertificateFooter.reserved">reserved</a></code></li>
<li><code><a title="sshkey_tools.cert.CertificateFooter.signature" href="#sshkey_tools.cert.CertificateFooter.signature">signature</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="sshkey_tools.cert.CertificateHeader" href="#sshkey_tools.cert.CertificateHeader">CertificateHeader</a></code></h4>
<ul class="">
<li><code><a title="sshkey_tools.cert.CertificateHeader.DECODE_ORDER" href="#sshkey_tools.cert.CertificateHeader.DECODE_ORDER">DECODE_ORDER</a></code></li>
<li><code><a title="sshkey_tools.cert.CertificateHeader.nonce" href="#sshkey_tools.cert.CertificateHeader.nonce">nonce</a></code></li>
<li><code><a title="sshkey_tools.cert.CertificateHeader.pubkey_type" href="#sshkey_tools.cert.CertificateHeader.pubkey_type">pubkey_type</a></code></li>
<li><code><a title="sshkey_tools.cert.CertificateHeader.public_key" href="#sshkey_tools.cert.CertificateHeader.public_key">public_key</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="sshkey_tools.cert.DsaCertificate" href="#sshkey_tools.cert.DsaCertificate">DsaCertificate</a></code></h4>
<ul class="">
<li><code><a title="sshkey_tools.cert.DsaCertificate.DEFAULT_KEY_TYPE" href="#sshkey_tools.cert.DsaCertificate.DEFAULT_KEY_TYPE">DEFAULT_KEY_TYPE</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="sshkey_tools.cert.EcdsaCertificate" href="#sshkey_tools.cert.EcdsaCertificate">EcdsaCertificate</a></code></h4>
<ul class="">
<li><code><a title="sshkey_tools.cert.EcdsaCertificate.DEFAULT_KEY_TYPE" href="#sshkey_tools.cert.EcdsaCertificate.DEFAULT_KEY_TYPE">DEFAULT_KEY_TYPE</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="sshkey_tools.cert.Ed25519Certificate" href="#sshkey_tools.cert.Ed25519Certificate">Ed25519Certificate</a></code></h4>
<ul class="">
<li><code><a title="sshkey_tools.cert.Ed25519Certificate.DEFAULT_KEY_TYPE" href="#sshkey_tools.cert.Ed25519Certificate.DEFAULT_KEY_TYPE">DEFAULT_KEY_TYPE</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="sshkey_tools.cert.Fieldset" href="#sshkey_tools.cert.Fieldset">Fieldset</a></code></h4>
<ul class="two-column">
<li><code><a title="sshkey_tools.cert.Fieldset.DECODE_ORDER" href="#sshkey_tools.cert.Fieldset.DECODE_ORDER">DECODE_ORDER</a></code></li>
<li><code><a title="sshkey_tools.cert.Fieldset.decode" href="#sshkey_tools.cert.Fieldset.decode">decode</a></code></li>
<li><code><a title="sshkey_tools.cert.Fieldset.get" href="#sshkey_tools.cert.Fieldset.get">get</a></code></li>
<li><code><a title="sshkey_tools.cert.Fieldset.getattrs" href="#sshkey_tools.cert.Fieldset.getattrs">getattrs</a></code></li>
<li><code><a title="sshkey_tools.cert.Fieldset.replace_field" href="#sshkey_tools.cert.Fieldset.replace_field">replace_field</a></code></li>
<li><code><a title="sshkey_tools.cert.Fieldset.validate" href="#sshkey_tools.cert.Fieldset.validate">validate</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="sshkey_tools.cert.RsaCertificate" href="#sshkey_tools.cert.RsaCertificate">RsaCertificate</a></code></h4>
<ul class="">
<li><code><a title="sshkey_tools.cert.RsaCertificate.DEFAULT_KEY_TYPE" href="#sshkey_tools.cert.RsaCertificate.DEFAULT_KEY_TYPE">DEFAULT_KEY_TYPE</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="sshkey_tools.cert.SSHCertificate" href="#sshkey_tools.cert.SSHCertificate">SSHCertificate</a></code></h4>
<ul class="two-column">
<li><code><a title="sshkey_tools.cert.SSHCertificate.DEFAULT_KEY_TYPE" href="#sshkey_tools.cert.SSHCertificate.DEFAULT_KEY_TYPE">DEFAULT_KEY_TYPE</a></code></li>
<li><code><a title="sshkey_tools.cert.SSHCertificate.can_sign" href="#sshkey_tools.cert.SSHCertificate.can_sign">can_sign</a></code></li>
<li><code><a title="sshkey_tools.cert.SSHCertificate.create" href="#sshkey_tools.cert.SSHCertificate.create">create</a></code></li>
<li><code><a title="sshkey_tools.cert.SSHCertificate.decode" href="#sshkey_tools.cert.SSHCertificate.decode">decode</a></code></li>
<li><code><a title="sshkey_tools.cert.SSHCertificate.from_bytes" href="#sshkey_tools.cert.SSHCertificate.from_bytes">from_bytes</a></code></li>
<li><code><a title="sshkey_tools.cert.SSHCertificate.from_file" href="#sshkey_tools.cert.SSHCertificate.from_file">from_file</a></code></li>
<li><code><a title="sshkey_tools.cert.SSHCertificate.from_string" href="#sshkey_tools.cert.SSHCertificate.from_string">from_string</a></code></li>
<li><code><a title="sshkey_tools.cert.SSHCertificate.get" href="#sshkey_tools.cert.SSHCertificate.get">get</a></code></li>
<li><code><a title="sshkey_tools.cert.SSHCertificate.get_signable" href="#sshkey_tools.cert.SSHCertificate.get_signable">get_signable</a></code></li>
<li><code><a title="sshkey_tools.cert.SSHCertificate.replace_ca" href="#sshkey_tools.cert.SSHCertificate.replace_ca">replace_ca</a></code></li>
<li><code><a title="sshkey_tools.cert.SSHCertificate.set" href="#sshkey_tools.cert.SSHCertificate.set">set</a></code></li>
<li><code><a title="sshkey_tools.cert.SSHCertificate.sign" href="#sshkey_tools.cert.SSHCertificate.sign">sign</a></code></li>
<li><code><a title="sshkey_tools.cert.SSHCertificate.to_file" href="#sshkey_tools.cert.SSHCertificate.to_file">to_file</a></code></li>
<li><code><a title="sshkey_tools.cert.SSHCertificate.to_string" href="#sshkey_tools.cert.SSHCertificate.to_string">to_string</a></code></li>
<li><code><a title="sshkey_tools.cert.SSHCertificate.verify" href="#sshkey_tools.cert.SSHCertificate.verify">verify</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.10.0</a>.</p>
</footer>
</body>
</html>